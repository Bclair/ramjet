<!doctype html>
<html>
	<head>
		<title>ramjet tests</title>

		<style>
			body {
				font-family: 'arial';
				max-width: 800px;
				padding: 0 2em;
				margin: 0 auto;
				overflow-x: visible;
			}

			article {
				position: relative;
				width: 100%;
				border-bottom: 1px solid #eee;
			}

			article::before, article::after {
				content: ' ';
				display: table;
			}

			article::after {
				clear: both;
			}

			button {
				display: block;
				padding: 1em 2em;
				background-color: #eee;
				border: none;
				font-family: inherit;
				font-size: inherit;
				margin: 0 0 1em 0;
				cursor: pointer;
				color: #666;
				outline: none;
			}

			button:hover {
				background-color: #ddd;
				color: #333;
			}

			button:disabled {
				background-color: #eee;
				color: #666;
				opacity: 0.2;
				cursor: default;
			}

			.test-area {
				position: relative;
			}

			.a, .b {
				position: relative;
				width: 100px;
				height: 100px;
				line-height: 100px;
				color: white;
				text-align: center;
				font-size: 2em;
				box-sizing: border-box;
			}

			.a {
				float: left;
				background-color: #0074D9;
				border-color: #0074D9;
				fill: #0074D9;
			}

			.b {
				float: right;
				background-color: #01FF70;
				border-color: #01FF70;
				fill: #01FF70;
			}

			text {
				fill: white;
			}

			.container {
				position: absolute;
			}

			.transform-helper {
				position: absolute;
				left: 0;
				top: 0;
				right: 0;
				bottom: 0;
				border: 2px solid red;
				transition: all 0.6s ease-out;
			}

			.transform-helper-bg {
				position: absolute;
				width: 100px;
				height: 100px;
				border: 2px solid #999;
				box-sizing: border-box;
			}

			.screenshots {
				clear: both;
			}

			.screenshot-column {
				width: 33.333%;
				max-width: 200px;
				float: left;
				padding: 0 1em 0 0;
				box-sizing: border-box;
			}

			.screenshot-column img {
				width: 100%;
			}
		</style>

		<script src='data:application/javascript;base64,KGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHsKICAgICAgICAgICAgdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOgogICAgICAgICAgICB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOgogICAgICAgICAgICAoZ2xvYmFsLnJhbWpldCA9IGZhY3RvcnkoKSk7Cn0odGhpcywgZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7CgogICAgICAgICAgICB2YXIgYmFiZWxIZWxwZXJzID0ge307CgogICAgICAgICAgICBiYWJlbEhlbHBlcnMuY2xhc3NDYWxsQ2hlY2sgPSBmdW5jdGlvbiAoaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7CiAgICAgICAgICAgICAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGJhYmVsSGVscGVycy5jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgICAgICAgICAgICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOwogICAgICAgICAgICAgICAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogICAgICAgICAgICAgICAgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsKICAgICAgICAgICAgICAgIGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOwogICAgICAgICAgICAgICAgcmV0dXJuIENvbnN0cnVjdG9yOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0oKTsKCiAgICAgICAgICAgIGJhYmVsSGVscGVycy5zbGljZWRUb0FycmF5ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGZ1bmN0aW9uIHNsaWNlSXRlcmF0b3IoYXJyLCBpKSB7CiAgICAgICAgICAgICAgICB2YXIgX2FyciA9IFtdOwogICAgICAgICAgICAgICAgdmFyIF9uID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHZhciBfZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgdmFyIF9lID0gdW5kZWZpbmVkOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHsKICAgICAgICAgICAgICAgICAgICBfYXJyLnB1c2goX3MudmFsdWUpOwoKICAgICAgICAgICAgICAgICAgICBpZiAoaSAmJiBfYXJyLmxlbmd0aCA9PT0gaSkgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICBfZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgIF9lID0gZXJyOwogICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBpZiAoIV9uICYmIF9pWyJyZXR1cm4iXSkgX2lbInJldHVybiJdKCk7CiAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKF9kKSB0aHJvdyBfZTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfYXJyOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChhcnIsIGkpIHsKICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGFycikpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGFycjsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoU3ltYm9sLml0ZXJhdG9yIGluIE9iamVjdChhcnIpKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBzbGljZUl0ZXJhdG9yKGFyciwgaSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGF0dGVtcHQgdG8gZGVzdHJ1Y3R1cmUgbm9uLWl0ZXJhYmxlIGluc3RhbmNlIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSgpOwoKICAgICAgICAgICAgYmFiZWxIZWxwZXJzOwoKICAgICAgICAgICAgZnVuY3Rpb24gaGlkZU5vZGUobm9kZSkgewogICAgICAgICAgICAJbm9kZS5fX3JhbWpldE9yaWdpbmFsVHJhbnNpdGlvbl9fID0gbm9kZS5zdHlsZS53ZWJraXRUcmFuc2l0aW9uIHx8IG5vZGUuc3R5bGUudHJhbnNpdGlvbjsKICAgICAgICAgICAgCW5vZGUuX19yYW1qZXRPcmlnaW5hbE9wYWNpdHlfXyA9IG5vZGUuc3R5bGUub3BhY2l0eTsKCiAgICAgICAgICAgIAlub2RlLnN0eWxlLndlYmtpdFRyYW5zaXRpb24gPSBub2RlLnN0eWxlLnRyYW5zaXRpb24gPSAnJzsKCiAgICAgICAgICAgIAlub2RlLnN0eWxlLm9wYWNpdHkgPSAwOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBzaG93Tm9kZShub2RlKSB7CiAgICAgICAgICAgIAlpZiAoJ19fcmFtamV0T3JpZ2luYWxPcGFjaXR5X18nIGluIG5vZGUpIHsKICAgICAgICAgICAgCQlub2RlLnN0eWxlLnRyYW5zaXRpb24gPSAnJzsKICAgICAgICAgICAgCQlub2RlLnN0eWxlLm9wYWNpdHkgPSBub2RlLl9fcmFtamV0T3JpZ2luYWxPcGFjaXR5X187CgogICAgICAgICAgICAJCWlmIChub2RlLl9fcmFtamV0T3JpZ2luYWxUcmFuc2l0aW9uX18pIHsKICAgICAgICAgICAgCQkJc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIAkJCQlub2RlLnN0eWxlLnRyYW5zaXRpb24gPSBub2RlLl9fcmFtamV0T3JpZ2luYWxUcmFuc2l0aW9uX187CiAgICAgICAgICAgIAkJCX0pOwogICAgICAgICAgICAJCX0KICAgICAgICAgICAgCX0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gY2xvbmVOb2RlKG5vZGUpIHsKICAgICAgICAgICAgCXZhciBjbG9uZSA9IG5vZGUuY2xvbmVOb2RlKCk7CgogICAgICAgICAgICAJaWYgKG5vZGUubm9kZVR5cGUgPT09IDEpIHsKICAgICAgICAgICAgCQljbG9uZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgd2luZG93LmdldENvbXB1dGVkU3R5bGUobm9kZSkuY3NzVGV4dCk7CgogICAgICAgICAgICAJCXZhciBsZW4gPSBub2RlLmNoaWxkTm9kZXMubGVuZ3RoOwogICAgICAgICAgICAJCXZhciBpID0gdW5kZWZpbmVkOwoKICAgICAgICAgICAgCQlmb3IgKGkgPSAwOyBpIDwgbGVuOyBpICs9IDEpIHsKICAgICAgICAgICAgCQkJY2xvbmUuYXBwZW5kQ2hpbGQoY2xvbmVOb2RlKG5vZGUuY2hpbGROb2Rlc1tpXSkpOwogICAgICAgICAgICAJCX0KICAgICAgICAgICAgCX0KCiAgICAgICAgICAgIAlyZXR1cm4gY2xvbmU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBiZ0NvbG9yUmVnZXhwID0gL15yZ2JhP1woKFxkKyksXHMqKFxkKyksXHMqKFxkKykoPzosXHMqKFxkPy5cZCspKT9cKSQvOwoKICAgICAgICAgICAgZnVuY3Rpb24gcGFyc2VDb2xvcihzdHIpIHsKICAgICAgICAgICAgCXZhciBtYXRjaCA9IGJnQ29sb3JSZWdleHAuZXhlYyhzdHIpOwoKICAgICAgICAgICAgCWlmICghbWF0Y2gpIHJldHVybiBudWxsOwoKICAgICAgICAgICAgCXJldHVybiB7CiAgICAgICAgICAgIAkJcjogK21hdGNoWzFdLAogICAgICAgICAgICAJCWc6ICttYXRjaFsyXSwKICAgICAgICAgICAgCQliOiArbWF0Y2hbM10sCiAgICAgICAgICAgIAkJYWxwaGE6IG1hdGNoWzRdID8gK21hdGNoWzRdIDogMQogICAgICAgICAgICAJfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIGJvcmRlclJhZGl1c1JlZ2V4ID0gL14oXGQrKXB4KD86IChcZCspcHgpPyQvOwoKICAgICAgICAgICAgZnVuY3Rpb24gcGFyc2VCb3JkZXJSYWRpdXMoc3RyKSB7CiAgICAgICAgICAgIAl2YXIgbWF0Y2ggPSBib3JkZXJSYWRpdXNSZWdleC5leGVjKHN0cik7CgogICAgICAgICAgICAJcmV0dXJuIG1hdGNoWzJdID8geyB4OiArbWF0Y2hbMV0sIHk6ICttYXRjaFsyXSB9IDogeyB4OiArbWF0Y2hbMV0sIHk6ICttYXRjaFsxXSB9OwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgc3ZnbnMgPSAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnOwoKICAgICAgICAgICAgZnVuY3Rpb24gZmluZFBhcmVudEJ5VGFnTmFtZShub2RlLCB0YWdOYW1lKSB7CiAgICAgICAgICAgIAl3aGlsZSAobm9kZSkgewogICAgICAgICAgICAJCWlmIChub2RlLnRhZ05hbWUgPT09IHRhZ05hbWUpIHsKICAgICAgICAgICAgCQkJcmV0dXJuIG5vZGU7CiAgICAgICAgICAgIAkJfQoKICAgICAgICAgICAgCQlub2RlID0gbm9kZS5wYXJlbnROb2RlOwogICAgICAgICAgICAJfQogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBmaW5kVHJhbnNmb3JtUGFyZW50KG5vZGUpIHsKICAgICAgICAgICAgCXZhciBpc1N2ZyA9IG5vZGUubmFtZXNwYWNlVVJJID09PSBzdmducyAmJiBub2RlLnRhZ05hbWUgIT09ICdzdmcnOwogICAgICAgICAgICAJcmV0dXJuIGlzU3ZnID8gZmluZFBhcmVudEJ5VGFnTmFtZShub2RlLCAnc3ZnJykgOiBub2RlLnBhcmVudE5vZGU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKCiAgICAgICAgICAgIHZhciBrZXlmcmFtZXNTdXBwb3J0ZWQgPSB0cnVlOwogICAgICAgICAgICB2YXIgVFJBTlNGT1JNID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgVFJBTlNGT1JNX09SSUdJTiA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgdmFyIFRSQU5TRk9STV9DU1MgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIHZhciBLRVlGUkFNRVMgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIHZhciBBTklNQVRJT04gPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIHZhciBBTklNQVRJT05fRElSRUNUSU9OID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgQU5JTUFUSU9OX0RVUkFUSU9OID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgQU5JTUFUSU9OX0lURVJBVElPTl9DT1VOVCA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgdmFyIEFOSU1BVElPTl9OQU1FID0gdW5kZWZpbmVkOwogICAgICAgICAgICB2YXIgQU5JTUFUSU9OX1RJTUlOR19GVU5DVElPTiA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgdmFyIEFOSU1BVElPTl9FTkQgPSB1bmRlZmluZWQ7CgogICAgICAgICAgICAvLyBXZSBoYXZlIHRvIGJyb3dzZXItc25pZmYgZm9yIElFMTEsIGJlY2F1c2UgaXQgd2FzIGFwcGFyZW50bHkgd3JpdHRlbgogICAgICAgICAgICAvLyBieSBhIGJhcnJlbCBvZiBzdG9uZWQgbW9ua2V5cyAtIGh0dHA6Ly9qc2ZpZGRsZS5uZXQvcmljaF9oYXJyaXMvb3F1THUycUwvCgogICAgICAgICAgICAvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzE3OTA3NDQ1L2hvdy10by1kZXRlY3QtaWUxMQogICAgICAgICAgICB2YXIgaXNJZTExID0gIXdpbmRvdy5BY3RpdmVYT2JqZWN0ICYmICdBY3RpdmVYT2JqZWN0JyBpbiB3aW5kb3c7CgogICAgICAgICAgICBpZiAoIWlzSWUxMSAmJiAoJ3RyYW5zZm9ybScgaW4gZGl2LnN0eWxlIHx8ICd3ZWJraXRUcmFuc2Zvcm0nIGluIGRpdi5zdHlsZSkgJiYgKCdhbmltYXRpb24nIGluIGRpdi5zdHlsZSB8fCAnd2Via2l0QW5pbWF0aW9uJyBpbiBkaXYuc3R5bGUpKSB7CiAgICAgICAgICAgIAlrZXlmcmFtZXNTdXBwb3J0ZWQgPSB0cnVlOwoKICAgICAgICAgICAgCWlmICgnd2Via2l0VHJhbnNmb3JtJyBpbiBkaXYuc3R5bGUpIHsKICAgICAgICAgICAgCQlUUkFOU0ZPUk0gPSAnd2Via2l0VHJhbnNmb3JtJzsKICAgICAgICAgICAgCQlUUkFOU0ZPUk1fQ1NTID0gJy13ZWJraXQtdHJhbnNmb3JtJzsKICAgICAgICAgICAgCQlUUkFOU0ZPUk1fT1JJR0lOID0gJ3dlYmtpdFRyYW5zZm9ybU9yaWdpbic7CiAgICAgICAgICAgIAl9IGVsc2UgewogICAgICAgICAgICAJCVRSQU5TRk9STSA9IFRSQU5TRk9STV9DU1MgPSAndHJhbnNmb3JtJzsKICAgICAgICAgICAgCQlUUkFOU0ZPUk1fT1JJR0lOID0gJ3RyYW5zZm9ybU9yaWdpbic7CiAgICAgICAgICAgIAl9CgogICAgICAgICAgICAJaWYgKCdhbmltYXRpb24nIGluIGRpdi5zdHlsZSkgewogICAgICAgICAgICAJCUtFWUZSQU1FUyA9ICdAa2V5ZnJhbWVzJzsKCiAgICAgICAgICAgIAkJQU5JTUFUSU9OID0gJ2FuaW1hdGlvbic7CiAgICAgICAgICAgIAkJQU5JTUFUSU9OX0RJUkVDVElPTiA9ICdhbmltYXRpb25EaXJlY3Rpb24nOwogICAgICAgICAgICAJCUFOSU1BVElPTl9EVVJBVElPTiA9ICdhbmltYXRpb25EdXJhdGlvbic7CiAgICAgICAgICAgIAkJQU5JTUFUSU9OX0lURVJBVElPTl9DT1VOVCA9ICdhbmltYXRpb25JdGVyYXRpb25Db3VudCc7CiAgICAgICAgICAgIAkJQU5JTUFUSU9OX05BTUUgPSAnYW5pbWF0aW9uTmFtZSc7CiAgICAgICAgICAgIAkJQU5JTUFUSU9OX1RJTUlOR19GVU5DVElPTiA9ICdhbmltYXRpb25UaW1pbmdGdW5jdGlvbic7CgogICAgICAgICAgICAJCUFOSU1BVElPTl9FTkQgPSAnYW5pbWF0aW9uZW5kJzsKICAgICAgICAgICAgCX0gZWxzZSB7CiAgICAgICAgICAgIAkJS0VZRlJBTUVTID0gJ0Atd2Via2l0LWtleWZyYW1lcyc7CgogICAgICAgICAgICAJCUFOSU1BVElPTiA9ICd3ZWJraXRBbmltYXRpb24nOwogICAgICAgICAgICAJCUFOSU1BVElPTl9ESVJFQ1RJT04gPSAnd2Via2l0QW5pbWF0aW9uRGlyZWN0aW9uJzsKICAgICAgICAgICAgCQlBTklNQVRJT05fRFVSQVRJT04gPSAnd2Via2l0QW5pbWF0aW9uRHVyYXRpb24nOwogICAgICAgICAgICAJCUFOSU1BVElPTl9JVEVSQVRJT05fQ09VTlQgPSAnd2Via2l0QW5pbWF0aW9uSXRlcmF0aW9uQ291bnQnOwogICAgICAgICAgICAJCUFOSU1BVElPTl9OQU1FID0gJ3dlYmtpdEFuaW1hdGlvbk5hbWUnOwogICAgICAgICAgICAJCUFOSU1BVElPTl9USU1JTkdfRlVOQ1RJT04gPSAnd2Via2l0QW5pbWF0aW9uVGltaW5nRnVuY3Rpb24nOwoKICAgICAgICAgICAgCQlBTklNQVRJT05fRU5EID0gJ3dlYmtpdEFuaW1hdGlvbkVuZCc7CiAgICAgICAgICAgIAl9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIAlrZXlmcmFtZXNTdXBwb3J0ZWQgPSBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIElERU5USVRZID0gWzEsIDAsIDAsIDEsIDAsIDBdOwoKICAgICAgICAgICAgZnVuY3Rpb24gbXVsdGlwbHkoX3JlZiwgX3JlZjIpIHsKICAgICAgICAgICAgCXZhciBfcmVmNCA9IGJhYmVsSGVscGVycy5zbGljZWRUb0FycmF5KF9yZWYsIDYpOwoKICAgICAgICAgICAgCXZhciBhMSA9IF9yZWY0WzBdOwogICAgICAgICAgICAJdmFyIGIxID0gX3JlZjRbMV07CiAgICAgICAgICAgIAl2YXIgYzEgPSBfcmVmNFsyXTsKICAgICAgICAgICAgCXZhciBkMSA9IF9yZWY0WzNdOwogICAgICAgICAgICAJdmFyIGUxID0gX3JlZjRbNF07CiAgICAgICAgICAgIAl2YXIgZjEgPSBfcmVmNFs1XTsKCiAgICAgICAgICAgIAl2YXIgX3JlZjMgPSBiYWJlbEhlbHBlcnMuc2xpY2VkVG9BcnJheShfcmVmMiwgNik7CgogICAgICAgICAgICAJdmFyIGEyID0gX3JlZjNbMF07CiAgICAgICAgICAgIAl2YXIgYjIgPSBfcmVmM1sxXTsKICAgICAgICAgICAgCXZhciBjMiA9IF9yZWYzWzJdOwogICAgICAgICAgICAJdmFyIGQyID0gX3JlZjNbM107CiAgICAgICAgICAgIAl2YXIgZTIgPSBfcmVmM1s0XTsKICAgICAgICAgICAgCXZhciBmMiA9IF9yZWYzWzVdOwoKICAgICAgICAgICAgCXJldHVybiBbYTEgKiBhMiArIGMxICogYjIsIC8vIGEKICAgICAgICAgICAgCWIxICogYTIgKyBkMSAqIGIyLCAvLyBiCiAgICAgICAgICAgIAlhMSAqIGMyICsgYzEgKiBkMiwgLy8gYwogICAgICAgICAgICAJYjEgKiBjMiArIGQxICogZDIsIC8vIGQKICAgICAgICAgICAgCWExICogZTIgKyBjMSAqIGYyICsgZTEsIC8vIGUKICAgICAgICAgICAgCWIxICogZTIgKyBkMSAqIGYyICsgZjEgLy8gZgogICAgICAgICAgICAJXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gaW52ZXJ0KF9yZWY1KSB7CiAgICAgICAgICAgIAl2YXIgX3JlZjYgPSBiYWJlbEhlbHBlcnMuc2xpY2VkVG9BcnJheShfcmVmNSwgNik7CgogICAgICAgICAgICAJdmFyIGEgPSBfcmVmNlswXTsKICAgICAgICAgICAgCXZhciBiID0gX3JlZjZbMV07CiAgICAgICAgICAgIAl2YXIgYyA9IF9yZWY2WzJdOwogICAgICAgICAgICAJdmFyIGQgPSBfcmVmNlszXTsKICAgICAgICAgICAgCXZhciBlID0gX3JlZjZbNF07CiAgICAgICAgICAgIAl2YXIgZiA9IF9yZWY2WzVdOwoKICAgICAgICAgICAgCXZhciBkZXRlcm1pbmFudCA9IGEgKiBkIC0gYyAqIGI7CgogICAgICAgICAgICAJcmV0dXJuIFtkIC8gZGV0ZXJtaW5hbnQsIC1iIC8gZGV0ZXJtaW5hbnQsIC1jIC8gZGV0ZXJtaW5hbnQsIGEgLyBkZXRlcm1pbmFudCwgKGMgKiBmIC0gZSAqIGQpIC8gZGV0ZXJtaW5hbnQsIChlICogYiAtIGEgKiBmKSAvIGRldGVybWluYW50XTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gcGFyc2VNYXRyaXhUcmFuc2Zvcm1TdHJpbmcodHJhbnNmb3JtKSB7CiAgICAgICAgICAgIAlpZiAodHJhbnNmb3JtLnNsaWNlKDAsIDcpICE9PSAnbWF0cml4KCcpIHsKICAgICAgICAgICAgCQl0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBwYXJzZSB0cmFuc2Zvcm0gc3RyaW5nICgnICsgdHJhbnNmb3JtICsgJyknKTsKICAgICAgICAgICAgCX0KCiAgICAgICAgICAgIAlyZXR1cm4gdHJhbnNmb3JtLnNsaWNlKDcsIC0xKS5zcGxpdCgnICcpLm1hcChwYXJzZUZsb2F0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gcGFyc2VUcmFuc2Zvcm1TdHJpbmcodHJhbnNmb3JtKSB7CiAgICAgICAgICAgIAl2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgICAgIAlkaXYuc3R5bGUud2Via2l0VHJhbnNmb3JtID0gZGl2LnN0eWxlLnRyYW5zZm9ybSA9IHRyYW5zZm9ybTsKCiAgICAgICAgICAgIAlkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpdik7CiAgICAgICAgICAgIAl2YXIgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKGRpdik7CiAgICAgICAgICAgIAl2YXIgbWF0cml4ID0gcGFyc2VNYXRyaXhUcmFuc2Zvcm1TdHJpbmcoc3R5bGVbVFJBTlNGT1JNXSk7CiAgICAgICAgICAgIAlkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGRpdik7CgogICAgICAgICAgICAJcmV0dXJuIG1hdHJpeDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Q3VtdWxhdGl2ZVRyYW5zZm9ybU1hdHJpeChub2RlKSB7CiAgICAgICAgICAgIAlpZiAobm9kZS5uYW1lc3BhY2VVUkkgPT09IHN2Z25zKSB7CiAgICAgICAgICAgIAkJdmFyIF9ub2RlJGdldENUTSA9IG5vZGUuZ2V0Q1RNKCk7CgogICAgICAgICAgICAJCXZhciBhID0gX25vZGUkZ2V0Q1RNLmE7CiAgICAgICAgICAgIAkJdmFyIGIgPSBfbm9kZSRnZXRDVE0uYjsKICAgICAgICAgICAgCQl2YXIgYyA9IF9ub2RlJGdldENUTS5jOwogICAgICAgICAgICAJCXZhciBkID0gX25vZGUkZ2V0Q1RNLmQ7CiAgICAgICAgICAgIAkJdmFyIGUgPSBfbm9kZSRnZXRDVE0uZTsKICAgICAgICAgICAgCQl2YXIgZiA9IF9ub2RlJGdldENUTS5mOwoKICAgICAgICAgICAgCQlyZXR1cm4gW2EsIGIsIGMsIGQsIGUsIGZdOwogICAgICAgICAgICAJfQoKICAgICAgICAgICAgCXZhciBtYXRyaXggPSBbMSwgMCwgMCwgMSwgMCwgMF07CgogICAgICAgICAgICAJd2hpbGUgKG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50KSB7CiAgICAgICAgICAgIAkJdmFyIGlzU3ZnID0gbm9kZS5uYW1lc3BhY2VVUkkgPT09IHN2Z25zICYmIG5vZGUudGFnTmFtZSAhPT0gJ3N2Zyc7CiAgICAgICAgICAgIAkJdmFyIHBhcmVudE1hdHJpeCA9IGlzU3ZnID8gZ2V0U3ZnVHJhbnNmb3JtTWF0cml4KG5vZGUpIDogZ2V0VHJhbnNmb3JtTWF0cml4KG5vZGUpOwoKICAgICAgICAgICAgCQlpZiAocGFyZW50TWF0cml4KSB7CiAgICAgICAgICAgIAkJCW1hdHJpeCA9IG11bHRpcGx5KHBhcmVudE1hdHJpeCwgbWF0cml4KTsKICAgICAgICAgICAgCQl9CgogICAgICAgICAgICAJCW5vZGUgPSBmaW5kVHJhbnNmb3JtUGFyZW50KG5vZGUpOwogICAgICAgICAgICAJfQoKICAgICAgICAgICAgCXJldHVybiBtYXRyaXg7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFRyYW5zZm9ybU1hdHJpeChub2RlKSB7CiAgICAgICAgICAgIAlpZiAobm9kZS5uYW1lc3BhY2VVUkkgPT09IHN2Z25zKSB7CiAgICAgICAgICAgIAkJdmFyIGN0bSA9IGdldEN1bXVsYXRpdmVUcmFuc2Zvcm1NYXRyaXgobm9kZSk7CiAgICAgICAgICAgIAkJdmFyIHBhcmVudENUTSA9IGdldEN1bXVsYXRpdmVUcmFuc2Zvcm1NYXRyaXgobm9kZS5wYXJlbnROb2RlKTsKICAgICAgICAgICAgCQlyZXR1cm4gbXVsdGlwbHkoaW52ZXJ0KHBhcmVudENUTSksIGN0bSk7CiAgICAgICAgICAgIAl9CgogICAgICAgICAgICAJdmFyIHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTsKICAgICAgICAgICAgCXZhciB0cmFuc2Zvcm0gPSBzdHlsZVtUUkFOU0ZPUk1dOwoKICAgICAgICAgICAgCWlmICh0cmFuc2Zvcm0gPT09ICdub25lJykgewogICAgICAgICAgICAJCXJldHVybiBudWxsOwogICAgICAgICAgICAJfQoKICAgICAgICAgICAgCXZhciBvcmlnaW4gPSBzdHlsZVtUUkFOU0ZPUk1fT1JJR0lOXS5zcGxpdCgnICcpLm1hcChwYXJzZUZsb2F0KTsKCiAgICAgICAgICAgIAl2YXIgbWF0cml4ID0gcGFyc2VNYXRyaXhUcmFuc2Zvcm1TdHJpbmcodHJhbnNmb3JtKTsKCiAgICAgICAgICAgIAkvLyBjb21wZW5zYXRlIGZvciB0aGUgdHJhbnNmb3JtIG9yaWdpbiAod2Ugd2FudCB0byBleHByZXNzIGV2ZXJ5dGhpbmcgaW4gWzAsMF0gdGVybXMpCiAgICAgICAgICAgIAltYXRyaXggPSBtdWx0aXBseShbMSwgMCwgMCwgMSwgb3JpZ2luWzBdLCBvcmlnaW5bMV1dLCBtYXRyaXgpOwogICAgICAgICAgICAJbWF0cml4ID0gbXVsdGlwbHkobWF0cml4LCBbMSwgMCwgMCwgMSwgLW9yaWdpblswXSwgLW9yaWdpblsxXV0pOwoKICAgICAgICAgICAgCS8vIFRPRE8gaWYgaXMgU1ZHLCBtdWx0aXBseSBieSBDVE0sIHRvIGFjY291bnQgZm9yIHZpZXdCb3gKCiAgICAgICAgICAgIAlyZXR1cm4gbWF0cml4OwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBnZXRTdmdUcmFuc2Zvcm1NYXRyaXgobm9kZSkgewogICAgICAgICAgICAJLy8gY29uc3QgeyBhLCBiLCBjLCBkLCBlLCBmIH0gPSBub2RlLmdldENUTSgpOwogICAgICAgICAgICAJLy8gcmV0dXJuIFsgYSwgYiwgYywgZCwgZSwgZiBdOwoKICAgICAgICAgICAgCXZhciB0cmFuc2Zvcm0gPSBub2RlLmdldEF0dHJpYnV0ZSgndHJhbnNmb3JtJyk7CiAgICAgICAgICAgIH0KCnZhciBtYXRyaXggPSBPYmplY3QuZnJlZXplKHsKICAgICAgICAgICAgCUlERU5USVRZOiBJREVOVElUWSwKICAgICAgICAgICAgCW11bHRpcGx5OiBtdWx0aXBseSwKICAgICAgICAgICAgCWludmVydDogaW52ZXJ0LAogICAgICAgICAgICAJcGFyc2VNYXRyaXhUcmFuc2Zvcm1TdHJpbmc6IHBhcnNlTWF0cml4VHJhbnNmb3JtU3RyaW5nLAogICAgICAgICAgICAJcGFyc2VUcmFuc2Zvcm1TdHJpbmc6IHBhcnNlVHJhbnNmb3JtU3RyaW5nLAogICAgICAgICAgICAJZ2V0Q3VtdWxhdGl2ZVRyYW5zZm9ybU1hdHJpeDogZ2V0Q3VtdWxhdGl2ZVRyYW5zZm9ybU1hdHJpeCwKICAgICAgICAgICAgCWdldFRyYW5zZm9ybU1hdHJpeDogZ2V0VHJhbnNmb3JtTWF0cml4LAogICAgICAgICAgICAJZ2V0U3ZnVHJhbnNmb3JtTWF0cml4OiBnZXRTdmdUcmFuc2Zvcm1NYXRyaXgKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBmdW5jdGlvbiBnZXRCb3VuZGluZ0NsaWVudFJlY3Qobm9kZSwgaW52ZXJ0ZWRQYXJlbnRDVE0pIHsKICAgICAgICAgICAgCXZhciBvcmlnaW5hbFRyYW5zZm9ybU9yaWdpbiA9IG5vZGUuc3R5bGVbVFJBTlNGT1JNX09SSUdJTl07CiAgICAgICAgICAgIAl2YXIgb3JpZ2luYWxUcmFuc2Zvcm0gPSBub2RlLnN0eWxlW1RSQU5TRk9STV07CiAgICAgICAgICAgIAl2YXIgb3JpZ2luYWxUcmFuc2Zvcm1BdHRyaWJ1dGUgPSBub2RlLmdldEF0dHJpYnV0ZSgndHJhbnNmb3JtJyk7IC8vIFNWRwoKICAgICAgICAgICAgCW5vZGUuc3R5bGVbVFJBTlNGT1JNX09SSUdJTl0gPSAnMCAwJzsKICAgICAgICAgICAgCW5vZGUuc3R5bGVbVFJBTlNGT1JNXSA9ICdtYXRyaXgoJyArIGludmVydGVkUGFyZW50Q1RNLmpvaW4oJywnKSArICcpJzsKCiAgICAgICAgICAgIAl2YXIgYmNyID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCiAgICAgICAgICAgIAkvLyByZXNldAogICAgICAgICAgICAJbm9kZS5zdHlsZVtUUkFOU0ZPUk1fT1JJR0lOXSA9IG9yaWdpbmFsVHJhbnNmb3JtT3JpZ2luOwogICAgICAgICAgICAJbm9kZS5zdHlsZVtUUkFOU0ZPUk1dID0gb3JpZ2luYWxUcmFuc2Zvcm07CiAgICAgICAgICAgIAlub2RlLnNldEF0dHJpYnV0ZSgndHJhbnNmb3JtJywgb3JpZ2luYWxUcmFuc2Zvcm1BdHRyaWJ1dGUgfHwgJycpOyAvLyBUT0RPIHJlbW92ZSBhdHRyaWJ1dGUgYWx0b2dldGhlciBpZiBudWxsPwoKICAgICAgICAgICAgCXJldHVybiBiY3I7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHZhciBIdG1sV3JhcHBlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgCWZ1bmN0aW9uIEh0bWxXcmFwcGVyKG5vZGUsIG9wdGlvbnMpIHsKICAgICAgICAgICAgCQliYWJlbEhlbHBlcnMuY2xhc3NDYWxsQ2hlY2sodGhpcywgSHRtbFdyYXBwZXIpOwoKICAgICAgICAgICAgCQl0aGlzLmluaXQobm9kZSwgb3B0aW9ucyk7CiAgICAgICAgICAgIAl9CgogICAgICAgICAgICAJYmFiZWxIZWxwZXJzLmNyZWF0ZUNsYXNzKEh0bWxXcmFwcGVyLCBbewogICAgICAgICAgICAJCWtleTogJ2luaXQnLAogICAgICAgICAgICAJCXZhbHVlOiBmdW5jdGlvbiBpbml0KG5vZGUpIHsKICAgICAgICAgICAgCQkJdGhpcy5fbm9kZSA9IG5vZGU7CgogICAgICAgICAgICAJCQl0aGlzLl9jbG9uZSA9IGNsb25lTm9kZShub2RlKTsKCiAgICAgICAgICAgIAkJCXZhciBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKG5vZGUpOwogICAgICAgICAgICAJCQl0aGlzLnN0eWxlID0gc3R5bGU7CgogICAgICAgICAgICAJCQkvLyB3ZSBuZWVkIHRvIGdldCB0aGUgJ25ha2VkJyBib3VuZGluZ0NsaWVudFJlY3QsIGkuZS4KICAgICAgICAgICAgCQkJLy8gd2l0aG91dCBhbnkgdHJhbnNmb3JtcwogICAgICAgICAgICAJCQl2YXIgcGFyZW50Q1RNID0gbm9kZS5uYW1lc3BhY2VVUkkgPT09ICdzdmcnID8gbm9kZS5wYXJlbnROb2RlLmdldFNjcmVlbkNUTSgpIDogZ2V0Q3VtdWxhdGl2ZVRyYW5zZm9ybU1hdHJpeChub2RlLnBhcmVudE5vZGUpOwogICAgICAgICAgICAJCQl0aGlzLmludmVydGVkUGFyZW50Q1RNID0gaW52ZXJ0KHBhcmVudENUTSk7CiAgICAgICAgICAgIAkJCXRoaXMudHJhbnNmb3JtID0gZ2V0VHJhbnNmb3JtTWF0cml4KG5vZGUpIHx8IElERU5USVRZOwogICAgICAgICAgICAJCQl0aGlzLmN0bSA9IG11bHRpcGx5KHBhcmVudENUTSwgdGhpcy50cmFuc2Zvcm0pOwoKICAgICAgICAgICAgCQkJdmFyIGJjciA9IGdldEJvdW5kaW5nQ2xpZW50UmVjdChub2RlLCB0aGlzLmludmVydGVkUGFyZW50Q1RNKTsKICAgICAgICAgICAgCQkJdGhpcy5iY3IgPSBiY3I7CgogICAgICAgICAgICAJCQl2YXIgb3BhY2l0eSA9ICtzdHlsZS5vcGFjaXR5OwoKICAgICAgICAgICAgCQkJdmFyIHJnYmEgPSBwYXJzZUNvbG9yKHN0eWxlLmJhY2tncm91bmRDb2xvcik7CgogICAgICAgICAgICAJCQkvLyBUT0RPIGNyZWF0ZSBhIGZsYXQgYXJyYXk/IGVhc2llciB0byB3b3JrIHdpdGggbGF0ZXI/CiAgICAgICAgICAgIAkJCXZhciBib3JkZXJSYWRpdXMgPSB7CiAgICAgICAgICAgIAkJCQl0bDogcGFyc2VCb3JkZXJSYWRpdXMoc3R5bGUuYm9yZGVyVG9wTGVmdFJhZGl1cyksCiAgICAgICAgICAgIAkJCQl0cjogcGFyc2VCb3JkZXJSYWRpdXMoc3R5bGUuYm9yZGVyVG9wUmlnaHRSYWRpdXMpLAogICAgICAgICAgICAJCQkJYnI6IHBhcnNlQm9yZGVyUmFkaXVzKHN0eWxlLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzKSwKICAgICAgICAgICAgCQkJCWJsOiBwYXJzZUJvcmRlclJhZGl1cyhzdHlsZS5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzKQogICAgICAgICAgICAJCQl9OwoKICAgICAgICAgICAgCQkJdGhpcy5ib3JkZXJSYWRpdXMgPSBib3JkZXJSYWRpdXM7CiAgICAgICAgICAgIAkJCXRoaXMub3BhY2l0eSA9IG9wYWNpdHk7CiAgICAgICAgICAgIAkJCXRoaXMucmdiYSA9IHJnYmE7CgogICAgICAgICAgICAJCQl0aGlzLmxlZnQgPSBiY3IubGVmdDsKICAgICAgICAgICAgCQkJdGhpcy50b3AgPSBiY3IudG9wOwogICAgICAgICAgICAJCQl0aGlzLndpZHRoID0gYmNyLndpZHRoOwogICAgICAgICAgICAJCQl0aGlzLmhlaWdodCA9IGJjci5oZWlnaHQ7CiAgICAgICAgICAgIAkJfQogICAgICAgICAgICAJfSwgewogICAgICAgICAgICAJCWtleTogJ2luc2VydCcsCiAgICAgICAgICAgIAkJdmFsdWU6IGZ1bmN0aW9uIGluc2VydCgpIHsKICAgICAgICAgICAgCQkJdmFyIGJjciA9IHRoaXMuYmNyOwoKICAgICAgICAgICAgCQkJdmFyIGNsb25lID0gdW5kZWZpbmVkOwogICAgICAgICAgICAJCQl2YXIgY29udGFpbmVyID0gdW5kZWZpbmVkOwoKICAgICAgICAgICAgCQkJaWYgKHRoaXMuX25vZGUubmFtZXNwYWNlVVJJID09PSBzdmducykgewogICAgICAgICAgICAJCQkJLy8gVE9ETyB3aGF0IGlmIGl0J3MgdGhlIDxzdmc+IGl0c2VsZiwgbm90IGEgY2hpbGQ/CiAgICAgICAgICAgIAkJCQl2YXIgc3ZnID0gZmluZFBhcmVudEJ5VGFnTmFtZSh0aGlzLl9ub2RlLCAnc3ZnJyk7IC8vIFRPRE8gc2hvdWxkIGJlIHRoZSBuYW1lc3BhY2UgYm91bmRhcnkgLSBjb3VsZCBiZSBTVkcgaW5zaWRlIFNWRwogICAgICAgICAgICAJCQkJY29udGFpbmVyID0gZmluZFRyYW5zZm9ybVBhcmVudChzdmcpOwoKICAgICAgICAgICAgCQkJCWNsb25lID0gc3ZnLmNsb25lTm9kZShmYWxzZSk7CiAgICAgICAgICAgIAkJCQljbG9uZS5hcHBlbmRDaGlsZCh0aGlzLl9jbG9uZSk7IC8vIFRPRE8gd2hhdCBhYm91dCB0cmFuc2Zvcm1zPwogICAgICAgICAgICAJCQl9IGVsc2UgewogICAgICAgICAgICAJCQkJCWNvbnRhaW5lciA9IGZpbmRUcmFuc2Zvcm1QYXJlbnQodGhpcy5fbm9kZSk7CiAgICAgICAgICAgIAkJCQkJY2xvbmUgPSB0aGlzLl9jbG9uZTsKICAgICAgICAgICAgCQkJCX0KCiAgICAgICAgICAgIAkJCXZhciBjb250YWluZXJTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGNvbnRhaW5lcik7CiAgICAgICAgICAgIAkJCXZhciBjb250YWluZXJCY3IgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3QoY29udGFpbmVyLCBpbnZlcnQoZ2V0Q3VtdWxhdGl2ZVRyYW5zZm9ybU1hdHJpeChjb250YWluZXIucGFyZW50Tm9kZSkpKTsKCiAgICAgICAgICAgIAkJCWNsb25lLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsKICAgICAgICAgICAgCQkJY2xvbmUuc3R5bGVbVFJBTlNGT1JNX09SSUdJTl0gPSAnMCAwJzsKICAgICAgICAgICAgCQkJY2xvbmUuc3R5bGUudG9wID0gYmNyLnRvcCAtIHBhcnNlSW50KHRoaXMuc3R5bGUubWFyZ2luVG9wLCAxMCkgLSAoY29udGFpbmVyQmNyLnRvcCAtIHBhcnNlSW50KGNvbnRhaW5lclN0eWxlLm1hcmdpblRvcCwgMTApKSArICdweCc7CiAgICAgICAgICAgIAkJCWNsb25lLnN0eWxlLmxlZnQgPSBiY3IubGVmdCAtIHBhcnNlSW50KHRoaXMuc3R5bGUubWFyZ2luTGVmdCwgMTApIC0gKGNvbnRhaW5lckJjci5sZWZ0IC0gcGFyc2VJbnQoY29udGFpbmVyU3R5bGUubWFyZ2luTGVmdCwgMTApKSArICdweCc7CgogICAgICAgICAgICAJCQljb250YWluZXIuYXBwZW5kQ2hpbGQoY2xvbmUpOwogICAgICAgICAgICAJCX0KICAgICAgICAgICAgCX0sIHsKICAgICAgICAgICAgCQlrZXk6ICdkZXRhY2gnLAogICAgICAgICAgICAJCXZhbHVlOiBmdW5jdGlvbiBkZXRhY2goKSB7CiAgICAgICAgICAgIAkJCXRoaXMuX2Nsb25lLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5fY2xvbmUpOwogICAgICAgICAgICAJCX0KICAgICAgICAgICAgCX0sIHsKICAgICAgICAgICAgCQlrZXk6ICdnZXRaSW5kZXgnLAogICAgICAgICAgICAJCXZhbHVlOiBmdW5jdGlvbiBnZXRaSW5kZXgoKSB7CiAgICAgICAgICAgIAkJCXJldHVybiBwYXJzZUZsb2F0KHRoaXMuX2Nsb25lLnN0eWxlLnpJbmRleCkgfHwgMDsKICAgICAgICAgICAgCQl9CiAgICAgICAgICAgIAl9LCB7CiAgICAgICAgICAgIAkJa2V5OiAnc2V0T3BhY2l0eScsCiAgICAgICAgICAgIAkJdmFsdWU6IGZ1bmN0aW9uIHNldE9wYWNpdHkob3BhY2l0eSkgewogICAgICAgICAgICAJCQl0aGlzLl9jbG9uZS5zdHlsZS5vcGFjaXR5ID0gb3BhY2l0eTsKICAgICAgICAgICAgCQl9CiAgICAgICAgICAgIAl9LCB7CiAgICAgICAgICAgIAkJa2V5OiAnc2V0VHJhbnNmb3JtJywKICAgICAgICAgICAgCQl2YWx1ZTogZnVuY3Rpb24gc2V0VHJhbnNmb3JtKHRyYW5zZm9ybSkgewogICAgICAgICAgICAJCQl0aGlzLl9jbG9uZS5zdHlsZS50cmFuc2Zvcm0gPSB0aGlzLl9jbG9uZS5zdHlsZS53ZWJraXRUcmFuc2Zvcm0gPSB0aGlzLl9jbG9uZS5zdHlsZS5tc1RyYW5zZm9ybSA9IHRyYW5zZm9ybTsKICAgICAgICAgICAgCQl9CiAgICAgICAgICAgIAl9LCB7CiAgICAgICAgICAgIAkJa2V5OiAnc2V0QmFja2dyb3VuZENvbG9yJywKICAgICAgICAgICAgCQl2YWx1ZTogZnVuY3Rpb24gc2V0QmFja2dyb3VuZENvbG9yKGNvbG9yKSB7CiAgICAgICAgICAgIAkJCXRoaXMuX2Nsb25lLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yOwogICAgICAgICAgICAJCX0KICAgICAgICAgICAgCX0sIHsKICAgICAgICAgICAgCQlrZXk6ICdzZXRCb3JkZXJSYWRpdXMnLAogICAgICAgICAgICAJCXZhbHVlOiBmdW5jdGlvbiBzZXRCb3JkZXJSYWRpdXMoYm9yZGVyUmFkaXVzKSB7CiAgICAgICAgICAgIAkJCXRoaXMuX2Nsb25lLnN0eWxlLmJvcmRlclJhZGl1cyA9IGJvcmRlclJhZGl1czsKICAgICAgICAgICAgCQl9CiAgICAgICAgICAgIAl9LCB7CiAgICAgICAgICAgIAkJa2V5OiAnc2V0WkluZGV4JywKICAgICAgICAgICAgCQl2YWx1ZTogZnVuY3Rpb24gc2V0WkluZGV4KGluZGV4KSB7CiAgICAgICAgICAgIAkJCXRoaXMuX2Nsb25lLnN0eWxlLnpJbmRleCA9IGluZGV4OwogICAgICAgICAgICAJCX0KICAgICAgICAgICAgCX0sIHsKICAgICAgICAgICAgCQlrZXk6ICdhbmltYXRlV2l0aEtleWZyYW1lcycsCiAgICAgICAgICAgIAkJdmFsdWU6IGZ1bmN0aW9uIGFuaW1hdGVXaXRoS2V5ZnJhbWVzKGlkLCBkdXJhdGlvbiwgY2FsbGJhY2spIHsKICAgICAgICAgICAgCQkJdGhpcy5fY2xvbmUuc3R5bGVbQU5JTUFUSU9OX0RJUkVDVElPTl0gPSAnYWx0ZXJuYXRlJzsKICAgICAgICAgICAgCQkJdGhpcy5fY2xvbmUuc3R5bGVbQU5JTUFUSU9OX0RVUkFUSU9OXSA9IGR1cmF0aW9uIC8gMTAwMCArICdzJzsKICAgICAgICAgICAgCQkJdGhpcy5fY2xvbmUuc3R5bGVbQU5JTUFUSU9OX0lURVJBVElPTl9DT1VOVF0gPSAxOwogICAgICAgICAgICAJCQl0aGlzLl9jbG9uZS5zdHlsZVtBTklNQVRJT05fTkFNRV0gPSBpZDsKICAgICAgICAgICAgCQkJdGhpcy5fY2xvbmUuc3R5bGVbQU5JTUFUSU9OX1RJTUlOR19GVU5DVElPTl0gPSAnbGluZWFyJzsKICAgICAgICAgICAgCQl9CiAgICAgICAgICAgIAl9LCB7CiAgICAgICAgICAgIAkJa2V5OiAnZnJlZXplJywKICAgICAgICAgICAgCQl2YWx1ZTogZnVuY3Rpb24gZnJlZXplKCkgewogICAgICAgICAgICAJCQl2YXIgY29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUodGhpcy5fY2xvbmUpOwoKICAgICAgICAgICAgCQkJdGhpcy5zZXRPcGFjaXR5KGNvbXB1dGVkU3R5bGUub3BhY2l0eSk7CiAgICAgICAgICAgIAkJCXRoaXMuc2V0VHJhbnNmb3JtKGNvbXB1dGVkU3R5bGUudHJhbnNmb3JtKTsKICAgICAgICAgICAgCQkJdGhpcy5zZXRCYWNrZ3JvdW5kQ29sb3IoY29tcHV0ZWRTdHlsZS5iYWNrZ3JvdW5kQ29sb3IpOwogICAgICAgICAgICAJCQl0aGlzLnNldEJvcmRlclJhZGl1cyhjb21wdXRlZFN0eWxlLmJvcmRlclJhZGl1cyk7CgogICAgICAgICAgICAJCQl0aGlzLl9jbG9uZS5zdHlsZVtBTklNQVRJT05dID0gJ25vbmUnOwogICAgICAgICAgICAJCX0KICAgICAgICAgICAgCX1dKTsKICAgICAgICAgICAgCXJldHVybiBIdG1sV3JhcHBlcjsKICAgICAgICAgICAgfSgpOwoKICAgICAgICAgICAgZnVuY3Rpb24gd3JhcE5vZGUobm9kZSwgb3B0aW9ucykgewogICAgICAgICAgICAJcmV0dXJuIG5ldyBIdG1sV3JhcHBlcihub2RlLCBvcHRpb25zKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gZ2V0T3BhY2l0eUludGVycG9sYXRvcihhLCBiKSB7CiAgICAgICAgICAgIAl2YXIgb3BhY2l0eSA9IHt9OwoKICAgICAgICAgICAgCXJldHVybiBmdW5jdGlvbiBpbnRlcnBvbGF0b3IodCkgewogICAgICAgICAgICAJCXZhciB0YXJnZXRPcGFjaXR5ID0gKGIgLSBhKSAqIHQgKyBhOwoKICAgICAgICAgICAgCQkvLyBCYXNlZCBvbiB0aGUgYmxlbmRpbmcgZm9ybXVsYSBoZXJlLiAoaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9BbHBoYV9jb21wb3NpdGluZyNBbHBoYV9ibGVuZGluZykKICAgICAgICAgICAgCQkvLyBUaGlzIGlzIGEgcXVhZHJhdGljIGJsZW5kaW5nIGZ1bmN0aW9uIHRoYXQgbWFrZXMgdGhlIHRvcCBsYXllciBhbmQgYm90dG9tIGxheWVyIGJsZW5kIGxpbmVhcmx5LgogICAgICAgICAgICAJCS8vIEhvd2V2ZXIgdGhlcmUgaXMgYW4gYXN5bXB0b3RlIGF0IHRhcmdldD0xIHNvIHRoYXQgbmVlZHMgdG8gYmUgaGFuZGxlZCB3aXRoIGFuIGlmIGVsc2Ugc3RhdGVtZW50LgogICAgICAgICAgICAJCWlmICh0YXJnZXRPcGFjaXR5ID09PSAxKSB7CiAgICAgICAgICAgIAkJCW9wYWNpdHkuZnJvbSA9IDE7CiAgICAgICAgICAgIAkJCW9wYWNpdHkudG8gPSB0OwogICAgICAgICAgICAJCX0gZWxzZSB7CiAgICAgICAgICAgIAkJCW9wYWNpdHkuZnJvbSA9IHRhcmdldE9wYWNpdHkgLSB0ICogdCAqIHRhcmdldE9wYWNpdHk7CiAgICAgICAgICAgIAkJCW9wYWNpdHkudG8gPSAodGFyZ2V0T3BhY2l0eSAtIG9wYWNpdHkuZnJvbSkgLyAoMSAtIG9wYWNpdHkuZnJvbSk7CiAgICAgICAgICAgIAkJfQoKICAgICAgICAgICAgCQlyZXR1cm4gb3BhY2l0eTsKICAgICAgICAgICAgCX07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIGdldFJnYmFJbnRlcnBvbGF0b3IoYSwgYikgewogICAgICAgICAgICAJaWYgKGEuYWxwaGEgPT09IDEgJiYgYi5hbHBoYSA9PT0gMSkgewogICAgICAgICAgICAJCS8vIG5vIG5lZWQgdG8gYW5pbWF0ZSBhbnl0aGluZwogICAgICAgICAgICAJCXJldHVybiBudWxsOwogICAgICAgICAgICAJfQoKICAgICAgICAgICAgCXZhciByZ2JhID0ge307CiAgICAgICAgICAgIAl2YXIgb3BhY2l0eUF0ID0gZ2V0T3BhY2l0eUludGVycG9sYXRvcihhLmFscGhhLCBiLmFscGhhKTsKCiAgICAgICAgICAgIAlyZXR1cm4gZnVuY3Rpb24gaW50ZXJwb2xhdG9yKHQpIHsKICAgICAgICAgICAgCQl2YXIgb3BhY2l0eSA9IG9wYWNpdHlBdCh0KTsKCiAgICAgICAgICAgIAkJcmdiYS5mcm9tID0gJ3JnYmEoJyArIGEuciArICcsJyArIGEuZyArICcsJyArIGEuYiArICcsJyArIG9wYWNpdHkuZnJvbSArICcpJzsKICAgICAgICAgICAgCQlyZ2JhLnRvID0gJ3JnYmEoJyArIGIuciArICcsJyArIGIuZyArICcsJyArIGIuYiArICcsJyArIG9wYWNpdHkudG8gKyAnKSc7CgogICAgICAgICAgICAJCXJldHVybiByZ2JhOwogICAgICAgICAgICAJfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQm9yZGVyIHJhZGl1cyBpcyBnaXZlbiBhcyBhIHN0cmluZyBpbiB0aGUgZm9sbG93aW5nIGZvcm0KICAgICAgICAgICAgLy8KICAgICAgICAgICAgLy8gICAgIHRsLnggdHIueCBici54IGJsLnggLyB0bC55IHRyLnkgYnIueSBibC55CiAgICAgICAgICAgIC8vCiAgICAgICAgICAgIC8vIC4uLndoZXJlIHQsIHIsIGIgYW5kIGwgYXJlIHRvcCwgcmlnaHQsIGJvdHRvbSwgbGVmdCwgYW5kCiAgICAgICAgICAgIC8vIHggYW5kIHkgYXJlIHNlbGYtZXhwbGFuYXRvcnkuIEVhY2ggdmFsdWUgaXMgZm9sbG93ZWQgYnkgJ3B4JwoKICAgICAgICAgICAgLy8gVE9ETyBpdCBtdXN0IGJlIHBvc3NpYmxlIHRvIGRvIHRoaXMgbW9yZSBzaW1wbHkuIE1heWJlIGhhdmUKICAgICAgICAgICAgLy8gYSBmbGF0IGFycmF5IGZyb20gdGhlIHN0YXJ0PwoKICAgICAgICAgICAgZnVuY3Rpb24gZ2V0Qm9yZGVyUmFkaXVzSW50ZXJwb2xhdG9yKGEsIGIpIHsKICAgICAgICAgICAgCS8vIFRPRE8gZmFzdCBwYXRoIC0gbm8gdHJhbnNpdGlvbiBuZWVkZWQKCiAgICAgICAgICAgIAl2YXIgYVdpZHRoID0gYS53aWR0aDsKICAgICAgICAgICAgCXZhciBhSGVpZ2h0ID0gYS5oZWlnaHQ7CgogICAgICAgICAgICAJdmFyIGJXaWR0aCA9IGIud2lkdGg7CiAgICAgICAgICAgIAl2YXIgYkhlaWdodCA9IGIuaGVpZ2h0OwoKICAgICAgICAgICAgCWEgPSBhLmJvcmRlclJhZGl1czsKICAgICAgICAgICAgCWIgPSBiLmJvcmRlclJhZGl1czsKCiAgICAgICAgICAgIAl2YXIgYV94X3QwID0gW2EudGwueCwgYS50ci54LCBhLmJyLngsIGEuYmwueF07CiAgICAgICAgICAgIAl2YXIgYV95X3QwID0gW2EudGwueSwgYS50ci55LCBhLmJyLnksIGEuYmwueV07CgogICAgICAgICAgICAJdmFyIGJfeF90MSA9IFtiLnRsLngsIGIudHIueCwgYi5ici54LCBiLmJsLnhdOwogICAgICAgICAgICAJdmFyIGJfeV90MSA9IFtiLnRsLnksIGIudHIueSwgYi5ici55LCBiLmJsLnldOwoKICAgICAgICAgICAgCXZhciBhX3hfdDEgPSBiX3hfdDEubWFwKGZ1bmN0aW9uICh4KSB7CiAgICAgICAgICAgIAkJcmV0dXJuIHggKiBhV2lkdGggLyBiV2lkdGg7CiAgICAgICAgICAgIAl9KTsKICAgICAgICAgICAgCXZhciBhX3lfdDEgPSBiX3lfdDEubWFwKGZ1bmN0aW9uICh5KSB7CiAgICAgICAgICAgIAkJcmV0dXJuIHkgKiBhSGVpZ2h0IC8gYkhlaWdodDsKICAgICAgICAgICAgCX0pOwoKICAgICAgICAgICAgCXZhciBiX3hfdDAgPSBhX3hfdDAubWFwKGZ1bmN0aW9uICh4KSB7CiAgICAgICAgICAgIAkJcmV0dXJuIHggKiBiV2lkdGggLyBhV2lkdGg7CiAgICAgICAgICAgIAl9KTsKICAgICAgICAgICAgCXZhciBiX3lfdDAgPSBhX3lfdDAubWFwKGZ1bmN0aW9uICh5KSB7CiAgICAgICAgICAgIAkJcmV0dXJuIHkgKiBiSGVpZ2h0IC8gYUhlaWdodDsKICAgICAgICAgICAgCX0pOwoKICAgICAgICAgICAgCXZhciBheCA9IGludGVycG9sYXRlQXJyYXkoYV94X3QwLCBhX3hfdDEpOwogICAgICAgICAgICAJdmFyIGF5ID0gaW50ZXJwb2xhdGVBcnJheShhX3lfdDAsIGFfeV90MSk7CgogICAgICAgICAgICAJdmFyIGJ4ID0gaW50ZXJwb2xhdGVBcnJheShiX3hfdDAsIGJfeF90MSk7CiAgICAgICAgICAgIAl2YXIgYnkgPSBpbnRlcnBvbGF0ZUFycmF5KGJfeV90MCwgYl95X3QxKTsKCiAgICAgICAgICAgIAl2YXIgYm9yZGVyUmFkaXVzID0ge307CgogICAgICAgICAgICAJcmV0dXJuIGZ1bmN0aW9uIGludGVycG9sYXRvcih0KSB7CiAgICAgICAgICAgIAkJdmFyIHggPSBheCh0KTsKICAgICAgICAgICAgCQl2YXIgeSA9IGF5KHQpOwoKICAgICAgICAgICAgCQlib3JkZXJSYWRpdXMuZnJvbSA9IHguam9pbigncHggJykgKyAncHggLyAnICsgeS5qb2luKCdweCAnKSArICdweCc7CgogICAgICAgICAgICAJCXggPSBieCh0KTsKICAgICAgICAgICAgCQl5ID0gYnkodCk7CgogICAgICAgICAgICAJCWJvcmRlclJhZGl1cy50byA9IHguam9pbigncHggJykgKyAncHggLyAnICsgeS5qb2luKCdweCAnKSArICdweCc7CgogICAgICAgICAgICAJCXJldHVybiBib3JkZXJSYWRpdXM7CiAgICAgICAgICAgIAl9OwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBpbnRlcnBvbGF0ZUFycmF5KGEsIGIpIHsKICAgICAgICAgICAgCXZhciBsZW4gPSBhLmxlbmd0aDsKICAgICAgICAgICAgCXZhciBhcnJheSA9IG5ldyBBcnJheShsZW4pOwoKICAgICAgICAgICAgCXJldHVybiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAJCXZhciBpID0gbGVuOwogICAgICAgICAgICAJCXdoaWxlIChpLS0pIHsKICAgICAgICAgICAgCQkJYXJyYXlbaV0gPSBhW2ldICsgdCAqIChiW2ldIC0gYVtpXSk7CiAgICAgICAgICAgIAkJfQoKICAgICAgICAgICAgCQlyZXR1cm4gYXJyYXk7CiAgICAgICAgICAgIAl9OwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBUT0RPIHJlZmFjdG9yIHRoaXMsIEkgaGF2ZSBubyBpZGVhIGhvdyBpdCB3b3JrcwogICAgICAgICAgICBmdW5jdGlvbiBnZXRUcmFuc2Zvcm1JbnRlcnBvbGF0b3IoYSwgYikgewogICAgICAgICAgICAJdmFyIGFfc3RhcnQgPSBhLnRyYW5zZm9ybTsKICAgICAgICAgICAgCXZhciBhX3RvX2IgPSBbYi53aWR0aCAvIGEud2lkdGgsIDAsIDAsIGIuaGVpZ2h0IC8gYS5oZWlnaHQsIGIubGVmdCAtIGEubGVmdCwgYi50b3AgLSBhLnRvcF07CiAgICAgICAgICAgIAl2YXIgYV9lbmQgPSBtdWx0aXBseShtdWx0aXBseShhLmludmVydGVkUGFyZW50Q1RNLCBhX3RvX2IpLCBiLmN0bSk7CgogICAgICAgICAgICAJdmFyIHRyYW5zZm9ybSA9IFtdOwoKICAgICAgICAgICAgCXJldHVybiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAJCXRyYW5zZm9ybSA9IGFfc3RhcnQubWFwKGZ1bmN0aW9uIChmcm9tLCBpKSB7CiAgICAgICAgICAgIAkJCXZhciB0byA9IGFfZW5kW2ldOwoKICAgICAgICAgICAgCQkJcmV0dXJuIGZyb20gKyB0ICogKHRvIC0gZnJvbSk7CiAgICAgICAgICAgIAkJfSk7CgogICAgICAgICAgICAJCXJldHVybiAnbWF0cml4KCcgKyB0cmFuc2Zvcm0uam9pbignLCcpICsgJyknOwogICAgICAgICAgICAJfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gbGluZWFyKHBvcykgewogICAgICAgICAgICAJcmV0dXJuIHBvczsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gZWFzZUluKHBvcykgewogICAgICAgICAgICAJcmV0dXJuIE1hdGgucG93KHBvcywgMyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIGVhc2VPdXQocG9zKSB7CiAgICAgICAgICAgIAlyZXR1cm4gTWF0aC5wb3cocG9zIC0gMSwgMykgKyAxOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBlYXNlSW5PdXQocG9zKSB7CiAgICAgICAgICAgIAlpZiAoKHBvcyAvPSAwLjUpIDwgMSkgewogICAgICAgICAgICAJCXJldHVybiAwLjUgKiBNYXRoLnBvdyhwb3MsIDMpOwogICAgICAgICAgICAJfQoKICAgICAgICAgICAgCXJldHVybiAwLjUgKiAoTWF0aC5wb3cocG9zIC0gMiwgMykgKyAyKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHJBRiA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCBmdW5jdGlvbiAoZm4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZm4sIDE2KTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGZ1bmN0aW9uIHRpbWVyKGZyb20sIHRvLCBvcHRpb25zKSB7CiAgICAgICAgICAgIAl2YXIgZHVyYXRpb24gPSBvcHRpb25zLmR1cmF0aW9uIHx8IDQwMDsKICAgICAgICAgICAgCXZhciBlYXNpbmcgPSBvcHRpb25zLmVhc2luZyB8fCBsaW5lYXI7CgogICAgICAgICAgICAJdmFyIHVzZVRpbWVyID0gIWtleWZyYW1lc1N1cHBvcnRlZCB8fCAhIW9wdGlvbnMudXNlVGltZXI7CgogICAgICAgICAgICAJdmFyIG9wYWNpdHlBdCA9IGdldE9wYWNpdHlJbnRlcnBvbGF0b3IoZnJvbS5vcGFjaXR5LCB0by5vcGFjaXR5KTsKICAgICAgICAgICAgCXZhciBiYWNrZ3JvdW5kQ29sb3JBdCA9IGdldFJnYmFJbnRlcnBvbGF0b3IoZnJvbS5yZ2JhLCB0by5yZ2JhKTsKICAgICAgICAgICAgCXZhciBib3JkZXJSYWRpdXNBdCA9IGdldEJvcmRlclJhZGl1c0ludGVycG9sYXRvcihmcm9tLCB0byk7CiAgICAgICAgICAgIAl2YXIgdHJhbnNmb3JtRnJvbUF0ID0gZ2V0VHJhbnNmb3JtSW50ZXJwb2xhdG9yKGZyb20sIHRvKTsKICAgICAgICAgICAgCXZhciB0cmFuc2Zvcm1Ub0F0ID0gZ2V0VHJhbnNmb3JtSW50ZXJwb2xhdG9yKHRvLCBmcm9tKTsKCiAgICAgICAgICAgIAl2YXIgcnVubmluZyA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgCXZhciBkaXNwb3NlQ3NzID0gdW5kZWZpbmVkOwogICAgICAgICAgICAJdmFyIHRvcm5kb3duID0gdW5kZWZpbmVkOwoKICAgICAgICAgICAgCXZhciByZW1haW5pbmcgPSBkdXJhdGlvbjsKICAgICAgICAgICAgCXZhciBlbmRUaW1lID0gdW5kZWZpbmVkOwoKICAgICAgICAgICAgCWZ1bmN0aW9uIHRpY2soKSB7CiAgICAgICAgICAgIAkJaWYgKCFydW5uaW5nKSByZXR1cm47CgogICAgICAgICAgICAJCXZhciB0aW1lTm93ID0gRGF0ZS5ub3coKTsKICAgICAgICAgICAgCQlyZW1haW5pbmcgPSBlbmRUaW1lIC0gdGltZU5vdzsKCiAgICAgICAgICAgIAkJaWYgKHJlbWFpbmluZyA8IDApIHsKICAgICAgICAgICAgCQkJdHJhbnNmb3JtZXIudGVhcmRvd24oKTsKICAgICAgICAgICAgCQkJaWYgKG9wdGlvbnMuZG9uZSkgb3B0aW9ucy5kb25lKCk7CgogICAgICAgICAgICAJCQlyZXR1cm47CiAgICAgICAgICAgIAkJfQoKICAgICAgICAgICAgCQl2YXIgdCA9IGVhc2luZygxIC0gcmVtYWluaW5nIC8gZHVyYXRpb24pOwogICAgICAgICAgICAJCXRyYW5zZm9ybWVyLmdvdG8odCk7CgogICAgICAgICAgICAJCXJBRih0aWNrKTsKICAgICAgICAgICAgCX0KCiAgICAgICAgICAgIAl2YXIgdHJhbnNmb3JtZXIgPSB7CiAgICAgICAgICAgIAkJdGVhcmRvd246IGZ1bmN0aW9uIHRlYXJkb3duKCkgewogICAgICAgICAgICAJCQlydW5uaW5nID0gZmFsc2U7CiAgICAgICAgICAgIAkJCXRvcm5kb3duID0gdHJ1ZTsKCiAgICAgICAgICAgIAkJCWZyb20uZGV0YWNoKCk7CiAgICAgICAgICAgIAkJCXRvLmRldGFjaCgpOwoKICAgICAgICAgICAgCQkJZnJvbSA9IG51bGw7CiAgICAgICAgICAgIAkJCXRvID0gbnVsbDsKCiAgICAgICAgICAgIAkJCXJldHVybiB0cmFuc2Zvcm1lcjsKICAgICAgICAgICAgCQl9LAogICAgICAgICAgICAJCWdvdG86IGZ1bmN0aW9uIGdvdG8ocG9zKSB7CiAgICAgICAgICAgIAkJCXRyYW5zZm9ybWVyLnBhdXNlKCk7CgogICAgICAgICAgICAJCQl2YXIgdCA9IGVhc2luZyhwb3MpOwoKICAgICAgICAgICAgCQkJLy8gb3BhY2l0eQogICAgICAgICAgICAJCQl2YXIgb3BhY2l0eSA9IG9wYWNpdHlBdCh0KTsKICAgICAgICAgICAgCQkJZnJvbS5zZXRPcGFjaXR5KG9wYWNpdHkuZnJvbSk7CiAgICAgICAgICAgIAkJCXRvLnNldE9wYWNpdHkob3BhY2l0eS50byk7CgogICAgICAgICAgICAJCQkvLyBiYWNrZ3JvdW5kIGNvbG9yCiAgICAgICAgICAgIAkJCWlmIChiYWNrZ3JvdW5kQ29sb3JBdCkgewogICAgICAgICAgICAJCQkJdmFyIGJhY2tncm91bmRDb2xvciA9IGJhY2tncm91bmRDb2xvckF0KHQpOwogICAgICAgICAgICAJCQkJZnJvbS5zZXRCYWNrZ3JvdW5kQ29sb3IoYmFja2dyb3VuZENvbG9yLmZyb20pOwogICAgICAgICAgICAJCQkJdG8uc2V0QmFja2dyb3VuZENvbG9yKGJhY2tncm91bmRDb2xvci50byk7CiAgICAgICAgICAgIAkJCX0KCiAgICAgICAgICAgIAkJCS8vIGJvcmRlciByYWRpdXMKICAgICAgICAgICAgCQkJdmFyIGJvcmRlclJhZGl1cyA9IGJvcmRlclJhZGl1c0F0KHQpOwogICAgICAgICAgICAJCQlmcm9tLnNldEJvcmRlclJhZGl1cyhib3JkZXJSYWRpdXMuZnJvbSk7CiAgICAgICAgICAgIAkJCXRvLnNldEJvcmRlclJhZGl1cyhib3JkZXJSYWRpdXMudG8pOwoKICAgICAgICAgICAgCQkJLy8gdHJhbnNmb3JtCiAgICAgICAgICAgIAkJCXZhciB0cmFuc2Zvcm1Gcm9tID0gdHJhbnNmb3JtRnJvbUF0KHQpOwogICAgICAgICAgICAJCQl2YXIgdHJhbnNmb3JtVG8gPSB0cmFuc2Zvcm1Ub0F0KDEgLSB0KTsKICAgICAgICAgICAgCQkJZnJvbS5zZXRUcmFuc2Zvcm0odHJhbnNmb3JtRnJvbSk7CiAgICAgICAgICAgIAkJCXRvLnNldFRyYW5zZm9ybSh0cmFuc2Zvcm1Ubyk7CgogICAgICAgICAgICAJCQlyZXR1cm4gdHJhbnNmb3JtZXI7CiAgICAgICAgICAgIAkJfSwKICAgICAgICAgICAgCQlwYXVzZTogZnVuY3Rpb24gcGF1c2UoKSB7CiAgICAgICAgICAgIAkJCWlmICghcnVubmluZykgcmV0dXJuIHRyYW5zZm9ybWVyOwogICAgICAgICAgICAJCQlydW5uaW5nID0gZmFsc2U7CgogICAgICAgICAgICAJCQlpZiAoIXVzZVRpbWVyKSB7CiAgICAgICAgICAgIAkJCQkvLyBUT0RPIGRlcml2ZSBjdXJyZW50IHBvc2l0aW9uIHNvbWVob3csIHVzZSB0aGF0IHJhdGhlciB0aGFuCiAgICAgICAgICAgIAkJCQkvLyBjdXJyZW50IGNvbXB1dGVkIHN0eWxlIChmcm9tIGFuZCB0byBnZXQgb3V0IG9mIHN5bmMgaW4KICAgICAgICAgICAgCQkJCS8vIHNvbWUgYnJvd3NlcnM/KQogICAgICAgICAgICAJCQkJcmVtYWluaW5nID0gZW5kVGltZSAtIERhdGUubm93KCk7CgogICAgICAgICAgICAJCQkJZnJvbS5mcmVlemUoKTsKICAgICAgICAgICAgCQkJCXRvLmZyZWV6ZSgpOwogICAgICAgICAgICAJCQkJZGlzcG9zZUNzcygpOwogICAgICAgICAgICAJCQl9CgogICAgICAgICAgICAJCQlyZXR1cm4gdHJhbnNmb3JtZXI7CiAgICAgICAgICAgIAkJfSwKICAgICAgICAgICAgCQlwbGF5OiBmdW5jdGlvbiBwbGF5KCkgewogICAgICAgICAgICAJCQlpZiAocnVubmluZykgcmV0dXJuIHRyYW5zZm9ybWVyOwogICAgICAgICAgICAJCQlydW5uaW5nID0gdHJ1ZTsKCiAgICAgICAgICAgIAkJCWVuZFRpbWUgPSBEYXRlLm5vdygpICsgcmVtYWluaW5nOwoKICAgICAgICAgICAgCQkJaWYgKHVzZVRpbWVyKSB7CiAgICAgICAgICAgIAkJCQlyQUYodGljayk7CiAgICAgICAgICAgIAkJCX0gZWxzZSB7CiAgICAgICAgICAgIAkJCQl2YXIgX2dldEtleWZyYW1lcyA9IGdldEtleWZyYW1lcyhmcm9tLCB0bywgb3B0aW9ucy5lYXNpbmcgfHwgbGluZWFyLCByZW1haW5pbmcsIGR1cmF0aW9uKTsKCiAgICAgICAgICAgIAkJCQl2YXIgZnJvbUtleWZyYW1lcyA9IF9nZXRLZXlmcmFtZXMuZnJvbUtleWZyYW1lczsKICAgICAgICAgICAgCQkJCXZhciB0b0tleWZyYW1lcyA9IF9nZXRLZXlmcmFtZXMudG9LZXlmcmFtZXM7CgogICAgICAgICAgICAJCQkJdmFyIGZyb21JZCA9IGdlbmVyYXRlSWQoKTsKICAgICAgICAgICAgCQkJCXZhciB0b0lkID0gZ2VuZXJhdGVJZCgpOwoKICAgICAgICAgICAgCQkJCXZhciBjc3MgPSAnXG5cdFx0XHRcdFx0JyArIEtFWUZSQU1FUyArICcgJyArIGZyb21JZCArICcgeyAnICsgZnJvbUtleWZyYW1lcyArICcgfVxuXHRcdFx0XHRcdCcgKyBLRVlGUkFNRVMgKyAnICcgKyB0b0lkICsgJyAgIHsgJyArIHRvS2V5ZnJhbWVzICsgJyB9JzsKCiAgICAgICAgICAgIAkJCQlkaXNwb3NlQ3NzID0gYWRkQ3NzKGNzcyk7CgogICAgICAgICAgICAJCQkJZnJvbS5hbmltYXRlV2l0aEtleWZyYW1lcyhmcm9tSWQsIHJlbWFpbmluZyk7CiAgICAgICAgICAgIAkJCQl0by5hbmltYXRlV2l0aEtleWZyYW1lcyh0b0lkLCByZW1haW5pbmcpOwogICAgICAgICAgICAJCQl9CgogICAgICAgICAgICAJCQlyZXR1cm4gdHJhbnNmb3JtZXI7CiAgICAgICAgICAgIAkJfQogICAgICAgICAgICAJfTsKCiAgICAgICAgICAgIAkvLyBoYW5kbGUgYW5pbWF0aW9uIGVuZAogICAgICAgICAgICAJaWYgKCF1c2VUaW1lcikgewogICAgICAgICAgICAJCShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIAkJCXZhciBhbmltYXRpbmcgPSAyOwoKICAgICAgICAgICAgCQkJdmFyIGRvbmUgPSBmdW5jdGlvbiBkb25lKCkgewogICAgICAgICAgICAJCQkJaWYgKCEgLS1hbmltYXRpbmcpIHsKICAgICAgICAgICAgCQkJCQl0cmFuc2Zvcm1lci50ZWFyZG93bigpOwoKICAgICAgICAgICAgCQkJCQlpZiAob3B0aW9ucy5kb25lKSBvcHRpb25zLmRvbmUoKTsKCiAgICAgICAgICAgIAkJCQkJZGlzcG9zZUNzcygpOwogICAgICAgICAgICAJCQkJfQogICAgICAgICAgICAJCQl9OwoKICAgICAgICAgICAgCQkJZnJvbS5fY2xvbmUuYWRkRXZlbnRMaXN0ZW5lcihBTklNQVRJT05fRU5ELCBkb25lKTsKICAgICAgICAgICAgCQkJdG8uX2Nsb25lLmFkZEV2ZW50TGlzdGVuZXIoQU5JTUFUSU9OX0VORCwgZG9uZSk7CiAgICAgICAgICAgIAkJfSkoKTsKICAgICAgICAgICAgCX0KCiAgICAgICAgICAgIAl0cmFuc2Zvcm1lci5wbGF5KCk7CgogICAgICAgICAgICAJcmV0dXJuIHRyYW5zZm9ybWVyOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZUlkKCkgewogICAgICAgICAgICAJcmV0dXJuICdyYW1qZXQnICsgfiB+KE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gYWRkQ3NzKGNzcykgewogICAgICAgICAgICAJdmFyIHN0eWxlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7CiAgICAgICAgICAgIAlzdHlsZUVsZW1lbnQudHlwZSA9ICd0ZXh0L2Nzcyc7CgogICAgICAgICAgICAJdmFyIGhlYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdOwoKICAgICAgICAgICAgCS8vIEludGVybmV0IEV4cGxvZGVyIHdvbid0IGxldCB5b3UgdXNlIHN0eWxlU2hlZXQuaW5uZXJIVE1MIC0gd2UgaGF2ZSB0bwogICAgICAgICAgICAJLy8gdXNlIHN0eWxlU2hlZXQuY3NzVGV4dCBpbnN0ZWFkCiAgICAgICAgICAgIAl2YXIgc3R5bGVTaGVldCA9IHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0OwoKICAgICAgICAgICAgCWlmIChzdHlsZVNoZWV0KSB7CiAgICAgICAgICAgIAkJc3R5bGVTaGVldC5jc3NUZXh0ID0gY3NzOwogICAgICAgICAgICAJfSBlbHNlIHsKICAgICAgICAgICAgCQlzdHlsZUVsZW1lbnQuaW5uZXJIVE1MID0gY3NzOwogICAgICAgICAgICAJfQoKICAgICAgICAgICAgCWhlYWQuYXBwZW5kQ2hpbGQoc3R5bGVFbGVtZW50KTsKCiAgICAgICAgICAgIAlyZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAJCXJldHVybiBoZWFkLnJlbW92ZUNoaWxkKHN0eWxlRWxlbWVudCk7CiAgICAgICAgICAgIAl9OwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBnZXRLZXlmcmFtZXMoZnJvbSwgdG8sIGVhc2luZywgcmVtYWluaW5nLCBkdXJhdGlvbikgewogICAgICAgICAgICAJdmFyIG9wYWNpdHlBdCA9IGdldE9wYWNpdHlJbnRlcnBvbGF0b3IoZnJvbS5vcGFjaXR5LCB0by5vcGFjaXR5KTsKICAgICAgICAgICAgCXZhciBiYWNrZ3JvdW5kQ29sb3JBdCA9IGdldFJnYmFJbnRlcnBvbGF0b3IoZnJvbS5yZ2JhLCB0by5yZ2JhKTsKICAgICAgICAgICAgCXZhciBib3JkZXJSYWRpdXNBdCA9IGdldEJvcmRlclJhZGl1c0ludGVycG9sYXRvcihmcm9tLCB0byk7CiAgICAgICAgICAgIAl2YXIgdHJhbnNmb3JtRnJvbUF0ID0gZ2V0VHJhbnNmb3JtSW50ZXJwb2xhdG9yKGZyb20sIHRvKTsKICAgICAgICAgICAgCXZhciB0cmFuc2Zvcm1Ub0F0ID0gZ2V0VHJhbnNmb3JtSW50ZXJwb2xhdG9yKHRvLCBmcm9tKTsKCiAgICAgICAgICAgIAl2YXIgbnVtRnJhbWVzID0gcmVtYWluaW5nIC8gMTY7CgogICAgICAgICAgICAJdmFyIGZyb21LZXlmcmFtZXMgPSAnJzsKICAgICAgICAgICAgCXZhciB0b0tleWZyYW1lcyA9ICcnOwoKICAgICAgICAgICAgCWZ1bmN0aW9uIGFkZEtleWZyYW1lcyhwYywgdCkgewogICAgICAgICAgICAJCXZhciBvcGFjaXR5ID0gb3BhY2l0eUF0KHQpOwogICAgICAgICAgICAJCXZhciBiYWNrZ3JvdW5kQ29sb3IgPSBiYWNrZ3JvdW5kQ29sb3JBdCA/IGJhY2tncm91bmRDb2xvckF0KHQpIDogbnVsbDsKICAgICAgICAgICAgCQl2YXIgYm9yZGVyUmFkaXVzID0gYm9yZGVyUmFkaXVzQXQodCk7IC8vIFRPRE8gdGhpcyBuZWVkcyB0byBiZSBvcHRpb25hbCwgdG8gYXZvaWQgcmVwYWludHMKICAgICAgICAgICAgCQl2YXIgdHJhbnNmb3JtRnJvbSA9IHRyYW5zZm9ybUZyb21BdCh0KTsKICAgICAgICAgICAgCQl2YXIgdHJhbnNmb3JtVG8gPSB0cmFuc2Zvcm1Ub0F0KDEgLSB0KTsKCiAgICAgICAgICAgIAkJZnJvbUtleWZyYW1lcyArPSAnXG4nICsgKHBjICsgJyUgeycpICsgKCdvcGFjaXR5OiAnICsgb3BhY2l0eS5mcm9tICsgJzsnKSArIChUUkFOU0ZPUk1fQ1NTICsgJzogJyArIHRyYW5zZm9ybUZyb20gKyAnOycpICsgKGJhY2tncm91bmRDb2xvciA/ICdiYWNrZ3JvdW5kLWNvbG9yOiAnICsgYmFja2dyb3VuZENvbG9yLmZyb20gKyAnOycgOiAnJykgKyAoJ2JvcmRlci1yYWRpdXM6ICcgKyBib3JkZXJSYWRpdXMuZnJvbSArICc7JykgKyAnfSc7CgogICAgICAgICAgICAJCXRvS2V5ZnJhbWVzICs9ICdcbicgKyAocGMgKyAnJSB7JykgKyAoJ29wYWNpdHk6ICcgKyBvcGFjaXR5LnRvICsgJzsnKSArIChUUkFOU0ZPUk1fQ1NTICsgJzogJyArIHRyYW5zZm9ybVRvICsgJzsnKSArIChiYWNrZ3JvdW5kQ29sb3IgPyAnYmFja2dyb3VuZC1jb2xvcjogJyArIGJhY2tncm91bmRDb2xvci50byArICc7JyA6ICcnKSArICgnYm9yZGVyLXJhZGl1czogJyArIGJvcmRlclJhZGl1cy50byArICc7JykgKyAnfSc7CiAgICAgICAgICAgIAl9CgogICAgICAgICAgICAJdmFyIGkgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgIAl2YXIgc3RhcnRQb3MgPSAxIC0gcmVtYWluaW5nIC8gZHVyYXRpb247CgogICAgICAgICAgICAJZm9yIChpID0gMDsgaSA8IG51bUZyYW1lczsgaSArPSAxKSB7CiAgICAgICAgICAgIAkJdmFyIHJlbFBvcyA9IGkgLyBudW1GcmFtZXM7CiAgICAgICAgICAgIAkJdmFyIGFic1BvcyA9IHN0YXJ0UG9zICsgcmVtYWluaW5nIC8gZHVyYXRpb24gKiByZWxQb3M7CgogICAgICAgICAgICAJCXZhciBwYyA9IDEwMCAqIHJlbFBvczsKICAgICAgICAgICAgCQl2YXIgdCA9IGVhc2luZyhhYnNQb3MpOwoKICAgICAgICAgICAgCQlhZGRLZXlmcmFtZXMocGMsIHQpOwogICAgICAgICAgICAJfQoKICAgICAgICAgICAgCWFkZEtleWZyYW1lcygxMDAsIDEpOwoKICAgICAgICAgICAgCXJldHVybiB7IGZyb21LZXlmcmFtZXM6IGZyb21LZXlmcmFtZXMsIHRvS2V5ZnJhbWVzOiB0b0tleWZyYW1lcyB9OwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgcmFtamV0ID0gewogICAgICAgICAgICAJdHJhbnNmb3JtOiBmdW5jdGlvbiB0cmFuc2Zvcm0oZnJvbU5vZGUsIHRvTm9kZSkgewogICAgICAgICAgICAJCXZhciBvcHRpb25zID0gYXJndW1lbnRzLmxlbmd0aCA8PSAyIHx8IGFyZ3VtZW50c1syXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMl07CgogICAgICAgICAgICAJCWlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICAJCQlvcHRpb25zID0geyBkb25lOiBvcHRpb25zIH07CiAgICAgICAgICAgIAkJfQoKICAgICAgICAgICAgCQlpZiAoISgnZHVyYXRpb24nIGluIG9wdGlvbnMpKSB7CiAgICAgICAgICAgIAkJCW9wdGlvbnMuZHVyYXRpb24gPSA0MDA7CiAgICAgICAgICAgIAkJfQoKICAgICAgICAgICAgCQl2YXIgZnJvbSA9IHdyYXBOb2RlKGZyb21Ob2RlLCBvcHRpb25zKTsKICAgICAgICAgICAgCQl2YXIgdG8gPSB3cmFwTm9kZSh0b05vZGUsIG9wdGlvbnMpOwoKICAgICAgICAgICAgCQlmcm9tLnNldE9wYWNpdHkoMSk7CiAgICAgICAgICAgIAkJdG8uc2V0T3BhY2l0eSgwKTsKCiAgICAgICAgICAgIAkJZnJvbS5pbnNlcnQoKTsKICAgICAgICAgICAgCQl0by5pbnNlcnQoKTsKCiAgICAgICAgICAgIAkJLy8gVGhpcyB3aWxsIGZhaWwgaWYgYGZyb21gIGlzIGluc2lkZSBhIGRpZmZlcmVudCAoaGlnaGVyKQogICAgICAgICAgICAJCS8vIHN0YWNraW5nIGNvbnRleHQgdGhhbiBgdG9gLiBOb3QgbXVjaCB3ZSBjYW4gZG8gwq9cXyjjg4QpXy/CrwogICAgICAgICAgICAJCXRvLnNldFpJbmRleChNYXRoLm1heCh0by5nZXRaSW5kZXgoKSwgZnJvbS5nZXRaSW5kZXgoKSArIDEpKTsKCiAgICAgICAgICAgIAkJcmV0dXJuIHRpbWVyKGZyb20sIHRvLCBvcHRpb25zKTsKICAgICAgICAgICAgCX0sCiAgICAgICAgICAgIAloaWRlOiBmdW5jdGlvbiBoaWRlKCkgewogICAgICAgICAgICAJCWZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBub2RlcyA9IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICAgICAgICAJCQlub2Rlc1tfa2V5XSA9IGFyZ3VtZW50c1tfa2V5XTsKICAgICAgICAgICAgCQl9CgogICAgICAgICAgICAJCW5vZGVzLmZvckVhY2goaGlkZU5vZGUpOwogICAgICAgICAgICAJfSwKICAgICAgICAgICAgCXNob3c6IGZ1bmN0aW9uIHNob3coKSB7CiAgICAgICAgICAgIAkJZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBub2RlcyA9IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7CiAgICAgICAgICAgIAkJCW5vZGVzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07CiAgICAgICAgICAgIAkJfQoKICAgICAgICAgICAgCQlub2Rlcy5mb3JFYWNoKHNob3dOb2RlKTsKICAgICAgICAgICAgCX0sCgogICAgICAgICAgICAJLy8gZXhwb3NlIHNvbWUgYmFzaWMgZWFzaW5nIGZ1bmN0aW9ucwogICAgICAgICAgICAJbGluZWFyOiBsaW5lYXIsIGVhc2VJbjogZWFzZUluLCBlYXNlT3V0OiBlYXNlT3V0LCBlYXNlSW5PdXQ6IGVhc2VJbk91dCwKCiAgICAgICAgICAgIAkvLyBURU1QCiAgICAgICAgICAgIAltYXRyaXg6IG1hdHJpeAogICAgICAgICAgICB9OwoKICAgICAgICAgICAgcmV0dXJuIHJhbWpldDsKCn0pKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmFtamV0LnVtZC5qcy5tYXAK'></script>
	</head>

	<body>
		
		<article>
			<h1>background-rgba-opacities</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<p style='position: absolute'>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>

<div style='position: relative;'>
	<div class='a transparent'>a</div>
	<div class='b transparent'>b</div>
</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/background-rgba-opacities/actual/000.png'>
			<img src='screenshots/background-rgba-opacities/actual/020.png'>
			<img src='screenshots/background-rgba-opacities/actual/040.png'>
			<img src='screenshots/background-rgba-opacities/actual/060.png'>
			<img src='screenshots/background-rgba-opacities/actual/080.png'>
			<img src='screenshots/background-rgba-opacities/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/background-rgba-opacities/expected/000.png'>
			<img src='screenshots/background-rgba-opacities/expected/020.png'>
			<img src='screenshots/background-rgba-opacities/expected/040.png'>
			<img src='screenshots/background-rgba-opacities/expected/060.png'>
			<img src='screenshots/background-rgba-opacities/expected/080.png'>
			<img src='screenshots/background-rgba-opacities/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/background-rgba-opacities/diff/000.png'>
			<img src='screenshots/background-rgba-opacities/diff/020.png'>
			<img src='screenshots/background-rgba-opacities/diff/040.png'>
			<img src='screenshots/background-rgba-opacities/diff/060.png'>
			<img src='screenshots/background-rgba-opacities/diff/080.png'>
			<img src='screenshots/background-rgba-opacities/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>basic-transform</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<div class='a'>a</div>
<div class='b'>b</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/basic-transform/actual/000.png'>
			<img src='screenshots/basic-transform/actual/020.png'>
			<img src='screenshots/basic-transform/actual/040.png'>
			<img src='screenshots/basic-transform/actual/060.png'>
			<img src='screenshots/basic-transform/actual/080.png'>
			<img src='screenshots/basic-transform/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/basic-transform/expected/000.png'>
			<img src='screenshots/basic-transform/expected/020.png'>
			<img src='screenshots/basic-transform/expected/040.png'>
			<img src='screenshots/basic-transform/expected/060.png'>
			<img src='screenshots/basic-transform/expected/080.png'>
			<img src='screenshots/basic-transform/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/basic-transform/diff/000.png'>
			<img src='screenshots/basic-transform/diff/020.png'>
			<img src='screenshots/basic-transform/diff/040.png'>
			<img src='screenshots/basic-transform/diff/060.png'>
			<img src='screenshots/basic-transform/diff/080.png'>
			<img src='screenshots/basic-transform/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>border-radius</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<div class='a' style='border-radius: 1em;'>a</div>
<div class='b' style='width: 300px; height: 100px; border: 2px solid red; border-top-left-radius: 1em; border-bottom-right-radius: 1em;'>b</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/border-radius/actual/000.png'>
			<img src='screenshots/border-radius/actual/020.png'>
			<img src='screenshots/border-radius/actual/040.png'>
			<img src='screenshots/border-radius/actual/060.png'>
			<img src='screenshots/border-radius/actual/080.png'>
			<img src='screenshots/border-radius/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/border-radius/expected/000.png'>
			<img src='screenshots/border-radius/expected/020.png'>
			<img src='screenshots/border-radius/expected/040.png'>
			<img src='screenshots/border-radius/expected/060.png'>
			<img src='screenshots/border-radius/expected/080.png'>
			<img src='screenshots/border-radius/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/border-radius/diff/000.png'>
			<img src='screenshots/border-radius/diff/020.png'>
			<img src='screenshots/border-radius/diff/040.png'>
			<img src='screenshots/border-radius/diff/060.png'>
			<img src='screenshots/border-radius/diff/080.png'>
			<img src='screenshots/border-radius/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>html-to-svg</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<div class='a'>a</div>
<svg style='float: right; width: 200px; height: 150px; overflow: visible' viewBox='0 0 250 175'> <!-- TODO  -->
	<g class='b' transform='scale(1.5)'> <!-- TODO transform='rotate(30)' - is problematic -->
		<rect width='200' height='100'></rect>
		<text x='100' y='50'>b</text>
	</g>
</svg>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/html-to-svg/actual/000.png'>
			<img src='screenshots/html-to-svg/actual/020.png'>
			<img src='screenshots/html-to-svg/actual/040.png'>
			<img src='screenshots/html-to-svg/actual/060.png'>
			<img src='screenshots/html-to-svg/actual/080.png'>
			<img src='screenshots/html-to-svg/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/html-to-svg/expected/000.png'>
			<img src='screenshots/html-to-svg/expected/020.png'>
			<img src='screenshots/html-to-svg/expected/040.png'>
			<img src='screenshots/html-to-svg/expected/060.png'>
			<img src='screenshots/html-to-svg/expected/080.png'>
			<img src='screenshots/html-to-svg/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/html-to-svg/diff/000.png'>
			<img src='screenshots/html-to-svg/diff/020.png'>
			<img src='screenshots/html-to-svg/diff/040.png'>
			<img src='screenshots/html-to-svg/diff/060.png'>
			<img src='screenshots/html-to-svg/diff/080.png'>
			<img src='screenshots/html-to-svg/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>starting-opacity</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<p style='position: absolute'>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>

<div style='position: relative;'>
	<div class='a' style='opacity: 0.8;'>a</div>
	<div class='b' style='opacity: 0.4;'>b</div>
</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/starting-opacity/actual/000.png'>
			<img src='screenshots/starting-opacity/actual/020.png'>
			<img src='screenshots/starting-opacity/actual/040.png'>
			<img src='screenshots/starting-opacity/actual/060.png'>
			<img src='screenshots/starting-opacity/actual/080.png'>
			<img src='screenshots/starting-opacity/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/starting-opacity/expected/000.png'>
			<img src='screenshots/starting-opacity/expected/020.png'>
			<img src='screenshots/starting-opacity/expected/040.png'>
			<img src='screenshots/starting-opacity/expected/060.png'>
			<img src='screenshots/starting-opacity/expected/080.png'>
			<img src='screenshots/starting-opacity/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/starting-opacity/diff/000.png'>
			<img src='screenshots/starting-opacity/diff/020.png'>
			<img src='screenshots/starting-opacity/diff/040.png'>
			<img src='screenshots/starting-opacity/diff/060.png'>
			<img src='screenshots/starting-opacity/diff/080.png'>
			<img src='screenshots/starting-opacity/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>starting-transform-on-container-and-target</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<div class='transform-helper-bg'></div>
<div class='container' style='-webkit-transform: translate(50px,50px) rotate(10deg) scale(0.8,1);'>
	<div class='a' style='-webkit-transform: translate(50px,50px) rotate(10deg) scale(2,1);'>
		<div class='transform-helper'></div>
		a
	</div>
</div>
<div class='b'>b</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/starting-transform-on-container-and-target/actual/000.png'>
			<img src='screenshots/starting-transform-on-container-and-target/actual/020.png'>
			<img src='screenshots/starting-transform-on-container-and-target/actual/040.png'>
			<img src='screenshots/starting-transform-on-container-and-target/actual/060.png'>
			<img src='screenshots/starting-transform-on-container-and-target/actual/080.png'>
			<img src='screenshots/starting-transform-on-container-and-target/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/starting-transform-on-container-and-target/expected/000.png'>
			<img src='screenshots/starting-transform-on-container-and-target/expected/020.png'>
			<img src='screenshots/starting-transform-on-container-and-target/expected/040.png'>
			<img src='screenshots/starting-transform-on-container-and-target/expected/060.png'>
			<img src='screenshots/starting-transform-on-container-and-target/expected/080.png'>
			<img src='screenshots/starting-transform-on-container-and-target/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/starting-transform-on-container-and-target/diff/000.png'>
			<img src='screenshots/starting-transform-on-container-and-target/diff/020.png'>
			<img src='screenshots/starting-transform-on-container-and-target/diff/040.png'>
			<img src='screenshots/starting-transform-on-container-and-target/diff/060.png'>
			<img src='screenshots/starting-transform-on-container-and-target/diff/080.png'>
			<img src='screenshots/starting-transform-on-container-and-target/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>starting-transform-on-container</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<div class='transform-helper-bg'></div>
<div class='container' style='-webkit-transform: scale(0.5);'>
	<div class='a'>
		<div id='helper' class='transform-helper'></div>
		a
	</div>
</div>
<div class='b'>b</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/starting-transform-on-container/actual/000.png'>
			<img src='screenshots/starting-transform-on-container/actual/020.png'>
			<img src='screenshots/starting-transform-on-container/actual/040.png'>
			<img src='screenshots/starting-transform-on-container/actual/060.png'>
			<img src='screenshots/starting-transform-on-container/actual/080.png'>
			<img src='screenshots/starting-transform-on-container/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/starting-transform-on-container/expected/000.png'>
			<img src='screenshots/starting-transform-on-container/expected/020.png'>
			<img src='screenshots/starting-transform-on-container/expected/040.png'>
			<img src='screenshots/starting-transform-on-container/expected/060.png'>
			<img src='screenshots/starting-transform-on-container/expected/080.png'>
			<img src='screenshots/starting-transform-on-container/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/starting-transform-on-container/diff/000.png'>
			<img src='screenshots/starting-transform-on-container/diff/020.png'>
			<img src='screenshots/starting-transform-on-container/diff/040.png'>
			<img src='screenshots/starting-transform-on-container/diff/060.png'>
			<img src='screenshots/starting-transform-on-container/diff/080.png'>
			<img src='screenshots/starting-transform-on-container/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>starting-transform-on-target</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<div class='transform-helper-bg'></div>
<div class='a' style='transform: translate(50px,50px) rotate(10deg) scale(2,1);'>
	<div class='transform-helper'></div>
	a
</div>
<div class='b' style='transform: scale(0.5,1);'>b</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/starting-transform-on-target/actual/000.png'>
			<img src='screenshots/starting-transform-on-target/actual/020.png'>
			<img src='screenshots/starting-transform-on-target/actual/040.png'>
			<img src='screenshots/starting-transform-on-target/actual/060.png'>
			<img src='screenshots/starting-transform-on-target/actual/080.png'>
			<img src='screenshots/starting-transform-on-target/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/starting-transform-on-target/expected/000.png'>
			<img src='screenshots/starting-transform-on-target/expected/020.png'>
			<img src='screenshots/starting-transform-on-target/expected/040.png'>
			<img src='screenshots/starting-transform-on-target/expected/060.png'>
			<img src='screenshots/starting-transform-on-target/expected/080.png'>
			<img src='screenshots/starting-transform-on-target/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/starting-transform-on-target/diff/000.png'>
			<img src='screenshots/starting-transform-on-target/diff/020.png'>
			<img src='screenshots/starting-transform-on-target/diff/040.png'>
			<img src='screenshots/starting-transform-on-target/diff/060.png'>
			<img src='screenshots/starting-transform-on-target/diff/080.png'>
			<img src='screenshots/starting-transform-on-target/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>tk-1</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<div class='a'>a</div>
<div class='b' style='float: none; width: 80px; height: 80px; color: red'>b</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/tk-1/actual/000.png'>
			<img src='screenshots/tk-1/actual/020.png'>
			<img src='screenshots/tk-1/actual/040.png'>
			<img src='screenshots/tk-1/actual/060.png'>
			<img src='screenshots/tk-1/actual/080.png'>
			<img src='screenshots/tk-1/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/tk-1/expected/000.png'>
			<img src='screenshots/tk-1/expected/020.png'>
			<img src='screenshots/tk-1/expected/040.png'>
			<img src='screenshots/tk-1/expected/060.png'>
			<img src='screenshots/tk-1/expected/080.png'>
			<img src='screenshots/tk-1/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/tk-1/diff/000.png'>
			<img src='screenshots/tk-1/diff/020.png'>
			<img src='screenshots/tk-1/diff/040.png'>
			<img src='screenshots/tk-1/diff/060.png'>
			<img src='screenshots/tk-1/diff/080.png'>
			<img src='screenshots/tk-1/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>total-opacity</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<p style='position: absolute'>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>

<div style='position: relative;'>
	<div class='a'>a</div>
	<div class='b'>b</div>
</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/total-opacity/actual/000.png'>
			<img src='screenshots/total-opacity/actual/020.png'>
			<img src='screenshots/total-opacity/actual/040.png'>
			<img src='screenshots/total-opacity/actual/060.png'>
			<img src='screenshots/total-opacity/actual/080.png'>
			<img src='screenshots/total-opacity/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/total-opacity/expected/000.png'>
			<img src='screenshots/total-opacity/expected/020.png'>
			<img src='screenshots/total-opacity/expected/040.png'>
			<img src='screenshots/total-opacity/expected/060.png'>
			<img src='screenshots/total-opacity/expected/080.png'>
			<img src='screenshots/total-opacity/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/total-opacity/diff/000.png'>
			<img src='screenshots/total-opacity/diff/020.png'>
			<img src='screenshots/total-opacity/diff/040.png'>
			<img src='screenshots/total-opacity/diff/060.png'>
			<img src='screenshots/total-opacity/diff/080.png'>
			<img src='screenshots/total-opacity/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>transform-and-absolute-positioning</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<div class='intro' style='position: relative; width: 100%; height: 20em; margin: 0 0 1em 0;'>
	<div class='container' style='position: absolute; left: 33.333%; top: 50%; width: 66.666%; height: 50%;'>
		<p class='visible' data-a style='background-color: #2ECC40; color: white; padding: 0.5em;'>
			It doesn't care where they sit in the DOM tree, or what children they have...
		</p>
	</div>

	<div class='container' style='position: absolute; left: 33.333%; top: 0; width: 33.333%; height: 100%;'>
		<p data-b style='background-color: #85144b; color: white; padding: 0.5em; transform: scale(0.5,1);'>
			...or if they've got existing transforms!
		</p>
	</div>
</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/transform-and-absolute-positioning/actual/000.png'>
			<img src='screenshots/transform-and-absolute-positioning/actual/020.png'>
			<img src='screenshots/transform-and-absolute-positioning/actual/040.png'>
			<img src='screenshots/transform-and-absolute-positioning/actual/060.png'>
			<img src='screenshots/transform-and-absolute-positioning/actual/080.png'>
			<img src='screenshots/transform-and-absolute-positioning/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/transform-and-absolute-positioning/expected/000.png'>
			<img src='screenshots/transform-and-absolute-positioning/expected/020.png'>
			<img src='screenshots/transform-and-absolute-positioning/expected/040.png'>
			<img src='screenshots/transform-and-absolute-positioning/expected/060.png'>
			<img src='screenshots/transform-and-absolute-positioning/expected/080.png'>
			<img src='screenshots/transform-and-absolute-positioning/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/transform-and-absolute-positioning/diff/000.png'>
			<img src='screenshots/transform-and-absolute-positioning/diff/020.png'>
			<img src='screenshots/transform-and-absolute-positioning/diff/040.png'>
			<img src='screenshots/transform-and-absolute-positioning/diff/060.png'>
			<img src='screenshots/transform-and-absolute-positioning/diff/080.png'>
			<img src='screenshots/transform-and-absolute-positioning/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<article>
			<h1>z-index</h1>
			<button class='go'>go</button>
			<button class='show-all'>show start and end</button>

			<!--<div class='test-area'>-->
				<div class='container' style='position: relative;'>
	<div class='a' style='display: block; float: none;'>a</div>
</div>

<div class='container' style='position: relative;'>
	<div class='b' style='display: block; float: none;'>b</div>
</div>

			<!--</div>-->

			<div class='screenshots'>
				
		<div class='screenshot-column'>
			<h2>actual</h2>

			<img src='screenshots/z-index/actual/000.png'>
			<img src='screenshots/z-index/actual/020.png'>
			<img src='screenshots/z-index/actual/040.png'>
			<img src='screenshots/z-index/actual/060.png'>
			<img src='screenshots/z-index/actual/080.png'>
			<img src='screenshots/z-index/actual/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>expected</h2>

			<img src='screenshots/z-index/expected/000.png'>
			<img src='screenshots/z-index/expected/020.png'>
			<img src='screenshots/z-index/expected/040.png'>
			<img src='screenshots/z-index/expected/060.png'>
			<img src='screenshots/z-index/expected/080.png'>
			<img src='screenshots/z-index/expected/100.png'>
		</div>
	

		<div class='screenshot-column'>
			<h2>diff</h2>

			<img src='screenshots/z-index/diff/000.png'>
			<img src='screenshots/z-index/diff/020.png'>
			<img src='screenshots/z-index/diff/040.png'>
			<img src='screenshots/z-index/diff/060.png'>
			<img src='screenshots/z-index/diff/080.png'>
			<img src='screenshots/z-index/diff/100.png'>
		</div>
	
			</div>
		</article>
	

		<script>
			[].forEach.call( document.querySelectorAll( 'article' ), function ( article ) {
				var go = article.querySelector( '.go' );
				var showAll = article.querySelector( '.show-all' );

				var a = article.querySelector( '.a' ) || article.querySelector( '[data-a]' );
				var b = article.querySelector( '.b' ) || article.querySelector( '[data-b]' );

				var reversed;

				ramjet.hide( b );

				go.addEventListener( 'click', function ( event ) {
					var from = reversed ? b : a;
					var to = reversed ? a : b;

					go.disabled = true;

					ramjet.show( a, b );

					ramjet.transform( from, to, {
						done: function () {
							go.disabled = false;
							reversed = !reversed;
							ramjet.show( to );
						}
					});

					ramjet.hide( a, b );
				});

				showAll.addEventListener( 'click', function ( event ) {
					ramjet.show( a, b );
				});
			});
		</script>
	</body>
</html>
